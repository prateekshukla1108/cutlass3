
<!DOCTYPE html>


<html lang="en" data-content_root="./" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>CUTLASS Grouped Kernel Schedulers &#8212; My sample book</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css?v=be8a1c11" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="_static/doctools.js?v=9a2dae69"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="_static/copybutton.js?v=f281be69"></script>
    <script src="_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'grouped_scheduler';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Blackwell SM100 GEMMs" href="blackwell_functionality.html" />
    <link rel="prev" title="Dependent kernel launches" href="dependent_kernel_launch.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="overview.html">
  
  
  
  
  
    
    
      
    
    
    <img src="_static/logo.png" class="logo__image only-light" alt="My sample book - Home"/>
    <script>document.write(`<img src="_static/logo.png" class="logo__image only-dark" alt="My sample book - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="overview.html">
                    Overview
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Getting Started</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="quickstart.html">Quickstart</a></li>



<li class="toctree-l1"><a class="reference internal" href="terminology.html">CUTLASS Terminology</a></li>

<li class="toctree-l1"><a class="reference internal" href="ide_setup.html">IDE Setup for CUTLASS Development</a></li>
<li class="toctree-l1"><a class="reference internal" href="functionality.html">Functionality</a></li>

</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Core Concepts</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="fundamental_types.html">Fundamental Types</a></li>

<li class="toctree-l1"><a class="reference internal" href="layout.html">Layouts and Tensors</a></li>



<li class="toctree-l1"><a class="reference internal" href="tile_iterator_concept.html">Tile Iterator Concepts</a></li>

<li class="toctree-l1"><a class="reference internal" href="pipeline.html">Synchronization primitives</a></li>

<li class="toctree-l1"><a class="reference internal" href="code_organization.html">CUTLASS Code Organization</a></li>

<li class="toctree-l1"><a class="reference internal" href="programming_guidelines.html">Programming Guidelines</a></li>

<li class="toctree-l1"><a class="reference internal" href="utilities.html">CUTLASS Utilities</a></li>

</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Key Operations &amp; APIs</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="gemm_api.html">CUTLASS GEMM API</a></li>



<li class="toctree-l1"><a class="reference internal" href="gemm_api_3x.html">CUTLASS 3.0 GEMM API</a></li>



<li class="toctree-l1"><a class="reference internal" href="efficient_gemm.html">Efficient GEMM in CUDA</a></li>


<li class="toctree-l1"><a class="reference internal" href="implicit_gemm_convolution.html">CUTLASS Convolution</a></li>





</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">CUTLASS 3.x Specifics</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="cutlass_3x_design.html">CUTLASS 3.0 Design</a></li>
<li class="toctree-l1"><a class="reference internal" href="cutlass_3x_backwards_compatibility.html">CUTLASS 3.0 GEMM Backwards Compatibility</a></li>

</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">CUTE - Compositional Universal Tile Engine</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="cute/00_quickstart.html">Getting Started With CuTe</a></li>
<li class="toctree-l1"><a class="reference internal" href="cute/01_layout.html">CuTe Layouts</a></li>
<li class="toctree-l1"><a class="reference internal" href="cute/02_layout_algebra.html">CuTe Layout Algebra</a></li>
<li class="toctree-l1"><a class="reference internal" href="cute/03_tensor.html">CuTe Tensors</a></li>
<li class="toctree-l1"><a class="reference internal" href="cute/04_algorithms.html">CuTe Tensor algorithms</a></li>
<li class="toctree-l1"><a class="reference internal" href="cute/0t_mma_atom.html">CuTe’s support for Matrix Multiply-Accumulate instructions</a></li>
<li class="toctree-l1"><a class="reference internal" href="cute/0x_gemm_tutorial.html">CuTe dense matrix-matrix multiply tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="cute/0y_predication.html">Predication: What to do when tiling isn’t perfect</a></li>
<li class="toctree-l1"><a class="reference internal" href="cute/0z_tma_tensors.html">CuTe TMA Tensors</a></li>


</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Advanced Features &amp; Platform Specifics</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="dependent_kernel_launch.html">Dependent kernel launches</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">CUTLASS Grouped Kernel Schedulers</a></li>





<li class="toctree-l1"><a class="reference internal" href="blackwell_functionality.html">Blackwell SM100 GEMMs</a></li>


<li class="toctree-l1"><a class="reference internal" href="blackwell_cluster_launch_control.html">Blackwell Cluster Launch Control</a></li>

<li class="toctree-l1"><a class="reference internal" href="profiler.html">CUTLASS Profiler</a></li>




</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Building CUTLASS</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="build/building_in_windows_with_visual_studio.html">Building on Windows with Visual Studio</a></li>





<li class="toctree-l1"><a class="reference internal" href="build/building_with_clang_as_host_compiler.html">Building with Clang as host compiler</a></li>


</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book/issues/new?title=Issue%20on%20page%20%2Fgrouped_scheduler.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/grouped_scheduler.md" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.md</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>CUTLASS Grouped Kernel Schedulers</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">CUTLASS Grouped Kernel Schedulers</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#introduction-to-grouped-kernel-schedulers">Introduction to Grouped Kernel Schedulers</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#grouped-gemm-scheduler">Grouped GEMM Scheduler</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#computing-the-schedule-for-a-given-block">Computing the schedule for a given block</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#grouped-rank2k-scheduler">Grouped Rank2K Scheduler</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#inefficiency-of-grouped-gemm-scheduler-for-grouped-rank2k-problems">Inefficiency of grouped GEMM scheduler for grouped Rank2K problems</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#specializing-the-scheduler-for-triangular-problems">Specializing the scheduler for triangular problems</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#calculating-row-i-given-threadblock-id-t">Calculating row <code class="docutils literal notranslate"><span class="pre">i</span></code> given threadblock ID <code class="docutils literal notranslate"><span class="pre">t</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#calculating-column-j-given-threadblock-id-t-and-row-i">Calculating column <code class="docutils literal notranslate"><span class="pre">j</span></code> given threadblock ID <code class="docutils literal notranslate"><span class="pre">t</span></code> and row <code class="docutils literal notranslate"><span class="pre">i</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#accounting-for-non-square-grids">Accounting for non-square grids</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#handling-cases-with-grid-dimensions-that-aren-t-multiples-of-each-other">Handling cases with grid dimensions that aren’t multiples of each other</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#handling-upper-triangular-matrices">Handling upper-triangular matrices</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#scheduler-modes">Scheduler modes</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#groupschedulemode-kdeviceonly-default"><code class="docutils literal notranslate"><span class="pre">GroupScheduleMode::kDeviceOnly</span></code> (default)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#precomputing-schedules-on-the-host-groupschedulemode-khostprecompute">Precomputing schedules on the host: <code class="docutils literal notranslate"><span class="pre">GroupScheduleMode::kHostPrecompute</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#which-scheduler-mode-should-i-use">Which scheduler mode should I use?</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#how-are-the-parameters-used-as-input-to-the-grouped-kernel-e-g-ptra-lda-set-in-my-application">How are the parameters used as input to the grouped kernel (e.g., ptrA, lda) set in my application?</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#can-host-side-work-be-overlapped-with-other-device-kernels-in-my-application">Can host-side work be overlapped with other device kernels in my application?</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#how-compute-intensive-are-the-problems-in-my-group">How compute-intensive are the problems in my group?</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#improving-load-balance-by-sorting-problems">Improving Load Balance by Sorting Problems</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#potential-problems-with-imbalanced-k-dimension">Potential problems with imbalanced K dimension</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#potential-for-sorting-problems-to-reduce-imbalance">Potential for sorting problems to reduce imbalance</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#copyright">Copyright</a></li>
</ul>
</li>
</ul>

            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <p><img alt="ALT" src="../../images/gemm-hierarchy-with-epilogue-no-labels.png" /></p>
<section class="tex2jax_ignore mathjax_ignore" id="cutlass-grouped-kernel-schedulers">
<h1>CUTLASS Grouped Kernel Schedulers<a class="headerlink" href="#cutlass-grouped-kernel-schedulers" title="Link to this heading">#</a></h1>
<p>CUTLASS’s grouped kernel is a persistent kernel which launches multiple problems (e.g., GEMMs, SYR2Ks) within a
single CUDA kernel launch.</p>
<p>Unlike a conventional GEMMs in CUTLASS, which launch a number of threadblocks equal to the number
of tiles in the GEMM, CUTLASS grouped kernels typically launch a number of threadblocks that is
fewer than the total number of tiles across all problems in the group. Each threadblock is then
responsible for computing one or more tiles among the problems in the group. The grouped kernel
<em>scheduler</em> (referred to as the <em>problem visitor</em> in code) is responsible for assigning each
threadblock the sequence of tiles that it will compute within the group.</p>
<p>This document provides background on the functionality of the grouped kernel scheduler, and describes
various optimizations to the grouped kernel scheduler.</p>
<p><strong>Outline</strong></p>
<ul class="simple">
<li><p><a class="reference internal" href="#introduction-to-grouped-kernel-schedulers"><span class="std std-ref">Introduction to Grouped Kernel Schedulers</span></a></p></li>
<li><p><a class="reference internal" href="#grouped-gemm-scheduler"><span class="std std-ref">Grouped GEMM Scheduler</span></a></p></li>
<li><p><a class="reference internal" href="#grouped-rank2k-scheduler"><span class="std std-ref">Grouped Rank2K Scheduler</span></a></p></li>
<li><p><a class="reference internal" href="#scheduler-modes"><span class="std std-ref">Scheduler Modes</span></a></p></li>
<li><p><a class="reference internal" href="#improving-load-balance-by-sorting-problems"><span class="std std-ref">Improving Load Balance by Sorting Problems</span></a></p></li>
</ul>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="introduction-to-grouped-kernel-schedulers">
<h1>Introduction to Grouped Kernel Schedulers<a class="headerlink" href="#introduction-to-grouped-kernel-schedulers" title="Link to this heading">#</a></h1>
<p>Given a group of problem sizes and a grid of threadblocks, the scheduler’s job is to assign
tiles from problems in the group to threadblocks. Threadblocks in a grouped kernel persistently
execute a loop of querying the scheduler for the next tile to compute and performing the
kernel-level operations for that tile (e.g., MMA and epilogue). In pseudocode, this looks as
follows:</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="n">ProblemVisitor</span><span class="w"> </span><span class="n">problem_visitor</span><span class="p">;</span>
<span class="w"> </span>
<span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="n">problem_visitor</span><span class="p">.</span><span class="n">next_tile</span><span class="p">())</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">//</span>
<span class="w">    </span><span class="c1">// Get next tile index from scheduler</span>
<span class="w">    </span><span class="c1">//</span>
<span class="w"> </span>
<span class="w">    </span><span class="c1">//</span>
<span class="w">    </span><span class="c1">// Compute MMA and epilogue</span>
<span class="w">    </span><span class="c1">//</span>
<span class="w"> </span>
<span class="w">    </span><span class="c1">// Inform the scheduler that we are done with the current tile</span>
<span class="w">    </span><span class="n">problem_visitor</span><span class="p">.</span><span class="n">advance</span><span class="p">(</span><span class="n">gridDim</span><span class="p">.</span><span class="n">x</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The key functionality of the grouped kernel scheduler lies in the <code class="docutils literal notranslate"><span class="pre">next_tile()</span></code> method,
which determines which tile in the group the calling threadblock should compute next, if any.</p>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="grouped-gemm-scheduler">
<h1>Grouped GEMM Scheduler<a class="headerlink" href="#grouped-gemm-scheduler" title="Link to this heading">#</a></h1>
<p>The scheduler used by grouped GEMM assigns tiles in the group to threadblocks in a round-robin
fashion.</p>
<p>Consider, for example, the threadblock-to-tile mapping that occurs for a group of four GEMMs
each consisting of a grid of 2x2 tiles. Suppose that eight threadblocks are launched. The
figure below illustrates the threadblock ID assigned to each tile in each GEMM in the group.</p>
<p><img alt="ALT" src="../../images/grouped-gemm-schedule-2x2.png" /></p>
<p>A similar mapping for problems that do not have the same number of tiles
is shown below:</p>
<p><img alt="ALT" src="../../images/grouped-gemm-schedule-varied.png" /></p>
<section id="computing-the-schedule-for-a-given-block">
<h2>Computing the schedule for a given block<a class="headerlink" href="#computing-the-schedule-for-a-given-block" title="Link to this heading">#</a></h2>
<p>Each threadblock in the grouped GEMM computes its own schedule by calling
the <code class="docutils literal notranslate"><span class="pre">next_tile()</span></code> method described above.</p>
<p>To do this, the threadblock’s <code class="docutils literal notranslate"><span class="pre">ProblemVisitor</span></code> maintains a <code class="docutils literal notranslate"><span class="pre">thread_idx</span></code>
member that is initialized to <code class="docutils literal notranslate"><span class="pre">blockIdx.x</span></code> and is incremented by
<code class="docutils literal notranslate"><span class="pre">gridDim.x</span></code> between each tile computed (only the x dimension is used)
in the launch configuration for grouped kernels). The scheduler must
then figure out which GEMM in the group <code class="docutils literal notranslate"><span class="pre">tile_idx</span></code> belongs to, and which tile
within that problem it maps to.</p>
<ol class="arabic simple">
<li><p><strong>Determining which GEMM <code class="docutils literal notranslate"><span class="pre">tile_idx</span></code> maps to:</strong> The scheduler determines
the GEMM to which <code class="docutils literal notranslate"><span class="pre">tile_idx</span></code> belongs by iterating through GEMMs starting with
the most-recently visited GEMM, and adding the number of tiles within that
GEMM to a running variable <code class="docutils literal notranslate"><span class="pre">problem_tile_start</span></code>. The scheduler has found the
correct problem for this tile when <code class="docutils literal notranslate"><span class="pre">problem_tile_start</span> <span class="pre">&lt;=</span> <span class="pre">tile_idx</span> <span class="pre">&lt;</span> <span class="pre">problem_tile_start</span> <span class="pre">+</span> <span class="pre">tiles_in_problem</span></code>.</p></li>
<li><p><strong>Determining the tile within a GEMM <code class="docutils literal notranslate"><span class="pre">tile_idx</span></code> maps to:</strong> Once the GEMM
to which <code class="docutils literal notranslate"><span class="pre">tile_idx</span></code> maps has been located, the specific tile within that
GEMM that this block should compute is given by <code class="docutils literal notranslate"><span class="pre">tile_idx</span> <span class="pre">-</span> <span class="pre">problem_tile_start</span></code>.
Simple rasterization is then performed to map this one-dimensional tile ID
into the two-dimensional coordinate of the tile to compute in the GEMM.</p></li>
</ol>
<p>We describe how this search is accelerated in <a class="reference internal" href="#scheduler-modes"><span class="std std-ref">Scheduler Modes</span></a>.</p>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="grouped-rank2k-scheduler">
<h1>Grouped Rank2K Scheduler<a class="headerlink" href="#grouped-rank2k-scheduler" title="Link to this heading">#</a></h1>
<p>The previous section described the operation of the scheduler used
for grouped GEMM kernels. While this scheduler is sufficient for
correctly implementing grouped Rank2K operations (i.e., SYR2K and HER2K), it leads to significant inefficiencies.</p>
<p>We next describe these inefficiencies as well as how the CUTLASS
grouped Rank2K scheduler overcomes them.</p>
<section id="inefficiency-of-grouped-gemm-scheduler-for-grouped-rank2k-problems">
<h2>Inefficiency of grouped GEMM scheduler for grouped Rank2K problems<a class="headerlink" href="#inefficiency-of-grouped-gemm-scheduler-for-grouped-rank2k-problems" title="Link to this heading">#</a></h2>
<p>The grouped GEMM scheduler assumes that every tile in every GEMM in the group will
ultimately affect the output of the problem. This is not the case for Rank2K
problems, for which matrix C is either upper or lower triangular. Using the default
grouped GEMM scheduler for such problems will thus lead to threadblocks frequently
being assigned to tiles that exit early (e.g., due to being assigned to a tile in the
upper-triangular portion of a lower-triangular problem). This further leads to load
imbalance among threadblocks, as the grouped GEMM scheduler assigns nearly the same
number of tiles to all threadblocks, regardless of how many tiles are truly active.</p>
<p>Consider an example of a group of four SYR2K problems, each with matrix C consisting
of a grid of 2x2 tiles.  Matrix C in each problem is lower triangular, indicated by
shaded tiles. Consider that eight threadblocks are launched to compute the grouped
problem. The default grouped GEMM scheduler will assign threadblocks to tiles in the following order:</p>
<p><img alt="ALT" src="../../images/grouped-syr2k-schedule-using-grouped-gemm-scheduler.png" /></p>
<p>In this case, threadblocks 1 and 5 are continuously assigned to inactive tiles. In
scenarios in which problems within the group have varying size, we have observed
this to still lead to significant load imbalance.</p>
</section>
<section id="specializing-the-scheduler-for-triangular-problems">
<h2>Specializing the scheduler for triangular problems<a class="headerlink" href="#specializing-the-scheduler-for-triangular-problems" title="Link to this heading">#</a></h2>
<p>We seek to design a scheduler that more efficiently maps threadblocks to active tiles
for kernels that use triangular output matrices. The scheduler should ideally assign
threadblocks only to those tiles within lower-triangular portion of a
lower-triangular problem (and vice-versa for upper-triangular problems).</p>
<p>Using the example above, the resulting assignment of threadblocks to tiles from
such a scheduler might be:</p>
<p><img alt="ALT" src="../../images/grouped-syr2k-schedule-ideal.png" /></p>
<p>Achieving this schedule requires mapping from a threadblock ID to tile coordinates
<code class="docutils literal notranslate"><span class="pre">(i,</span> <span class="pre">j)</span></code>.</p>
<p>We will illustrate this by mapping a lower-triangular matrix with a 3x3 grid. We
first calculate row and column indices assuming one-indexed rows, tiles, and
threadblock IDs, and then subtract one to convert to zero-indexed versions. Our
description borrows heavily from the mapping described <a class="reference external" href="https://stackoverflow.com/a/40954159">here</a>.</p>
<p><img alt="ALT" src="../../images/grouped-syr2k-schedule-3x3.png" /></p>
<section id="calculating-row-i-given-threadblock-id-t">
<h3>Calculating row <code class="docutils literal notranslate"><span class="pre">i</span></code> given threadblock ID <code class="docutils literal notranslate"><span class="pre">t</span></code><a class="headerlink" href="#calculating-row-i-given-threadblock-id-t" title="Link to this heading">#</a></h3>
<p>For a given row i, all threadblock IDs t in that row satisfy the following:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">t</span> <span class="o">&lt;=</span> <span class="mi">1</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">+</span> <span class="mi">3</span> <span class="o">+</span> <span class="o">...</span> <span class="o">+</span> <span class="p">(</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">i</span>
</pre></div>
</div>
<p>The closed-form equation for the right-hand side is: <code class="docutils literal notranslate"><span class="pre">i(i+1)/2</span></code>.
Using this, we can solve for <code class="docutils literal notranslate"><span class="pre">i</span></code> given <code class="docutils literal notranslate"><span class="pre">t</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">t</span>  <span class="o">&lt;=</span> <span class="n">i</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span>
<span class="mi">2</span><span class="n">t</span> <span class="o">&lt;=</span> <span class="n">i</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="n">i</span>
<span class="mi">2</span><span class="n">t</span> <span class="o">&lt;=</span> <span class="n">i</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="n">i</span> <span class="o">+</span> <span class="mf">0.25</span> <span class="o">-</span> <span class="mf">0.25</span>
<span class="mi">2</span><span class="n">t</span> <span class="o">+</span> <span class="mf">0.25</span> <span class="o">&lt;=</span> <span class="n">i</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="n">i</span> <span class="o">+</span> <span class="mf">0.25</span>
<span class="mi">2</span><span class="n">t</span> <span class="o">+</span> <span class="mf">0.25</span> <span class="o">&lt;=</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mf">0.5</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span>
<span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="n">t</span> <span class="o">+</span> <span class="mf">0.25</span><span class="p">)</span> <span class="o">-</span> <span class="mf">0.5</span> <span class="o">&lt;=</span> <span class="n">i</span>
</pre></div>
</div>
<p>To account for fractional values, we set:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">i</span> <span class="o">=</span> <span class="n">ceil</span><span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="n">t</span> <span class="o">+</span> <span class="mf">0.25</span><span class="p">)</span> <span class="o">-</span> <span class="mf">0.5</span><span class="p">)</span>
</pre></div>
</div>
<p>To turn this into a zero-indexed row and work with zero-indexed <code class="docutils literal notranslate"><span class="pre">t</span></code>, we perform:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">i</span> <span class="o">=</span> <span class="n">ceil</span><span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">(</span><span class="n">t</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="mf">0.25</span><span class="p">)</span> <span class="o">-</span> <span class="mf">0.5</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
  <span class="o">=</span> <span class="n">ceil</span><span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="n">t</span> <span class="o">+</span> <span class="mf">2.25</span><span class="p">)</span> <span class="o">-</span> <span class="mf">0.5</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
</pre></div>
</div>
</section>
<section id="calculating-column-j-given-threadblock-id-t-and-row-i">
<h3>Calculating column <code class="docutils literal notranslate"><span class="pre">j</span></code> given threadblock ID <code class="docutils literal notranslate"><span class="pre">t</span></code> and row <code class="docutils literal notranslate"><span class="pre">i</span></code><a class="headerlink" href="#calculating-column-j-given-threadblock-id-t-and-row-i" title="Link to this heading">#</a></h3>
<p>For a given row <code class="docutils literal notranslate"><span class="pre">i</span></code>, all threadblock IDs <code class="docutils literal notranslate"><span class="pre">t</span></code> in that row also satisfy the following:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>    <span class="n">t</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">+</span> <span class="mi">3</span> <span class="o">+</span> <span class="o">...</span> <span class="o">+</span> <span class="p">(</span><span class="n">i</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="o">--&gt;</span> <span class="n">t</span> <span class="o">&gt;</span> <span class="n">i</span><span class="p">(</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span>
</pre></div>
</div>
<p>Threadblock IDs within a given row are sequential, so the one-indexed column ID
for one-indexed threadblock ID <code class="docutils literal notranslate"><span class="pre">t</span></code> and row <code class="docutils literal notranslate"><span class="pre">i</span></code> is:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">j</span> <span class="o">=</span> <span class="n">t</span> <span class="o">-</span> <span class="p">(</span><span class="n">i</span><span class="p">(</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
<p>The zero-indexed version becomes:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">j</span> <span class="o">=</span> <span class="p">(</span><span class="n">t</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="n">i</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span><span class="mi">1</span>
  <span class="o">=</span> <span class="n">t</span> <span class="o">-</span> <span class="p">(</span><span class="n">i</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="accounting-for-non-square-grids">
<h3>Accounting for non-square grids<a class="headerlink" href="#accounting-for-non-square-grids" title="Link to this heading">#</a></h3>
<p>Though the overall output problem size for Rank2K problems is guaranteed to be square, the
grids used in computing may not be square due to using non-square threadblock shapes. For
example, a threadblock shape of 64x32 operating on a problem of output size 128x128 would
result in a grid of 2x4 tiles.</p>
<p>This case can be handled by noting that the output resembles a square grid of 2x2 “macro tiles”
each of which contains 2 “true tiles.” We can thus first map a threadblock ID to its “macro tile”
using the equations above, and then map it to the “true tile” within its “macro tile.” In the example
of a 2x4 grid, this mapping would look as follows:</p>
<p><img alt="ALT" src="../../images/grouped-syr2k-schedule-macro.png" /></p>
<p>A zero-indexed threadblock ID <code class="docutils literal notranslate"><span class="pre">t</span></code> is mapped to its “macro tile ID” <code class="docutils literal notranslate"><span class="pre">t_macro</span></code> as:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">t_macro</span> <span class="o">=</span> <span class="n">t</span> <span class="o">//</span> <span class="n">r</span>
</pre></div>
</div>
<p>Where <code class="docutils literal notranslate"><span class="pre">r</span></code> is the ratio of the maximum dimension of the grid to the
minimum dimension of the grid (i.e., <code class="docutils literal notranslate"><span class="pre">r</span> <span class="pre">=</span> <span class="pre">4</span> <span class="pre">/</span> <span class="pre">2</span> <span class="pre">=</span> <span class="pre">2</span></code> in the previous example).</p>
<p>One uses <code class="docutils literal notranslate"><span class="pre">t_macro</span></code> and the calculations above to find the row and column in the square matrix to
obtain <code class="docutils literal notranslate"><span class="pre">i_macro</span></code> and <code class="docutils literal notranslate"><span class="pre">j_macro</span></code> (zero-indexed). The mapping from <code class="docutils literal notranslate"><span class="pre">(i_macro,</span> <span class="pre">j_macro)</span> <span class="pre">--&gt;</span> <span class="pre">(i,</span> <span class="pre">j)</span></code>
is simply the following:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="p">(</span><span class="n">ThreadblockShape</span><span class="p">::</span><span class="n">M</span> <span class="o">&gt;</span> <span class="n">ThreadblockShape</span><span class="p">::</span><span class="n">N</span><span class="p">):</span>
    <span class="n">r</span> <span class="o">=</span> <span class="n">ThreadblockShape</span><span class="p">::</span><span class="n">M</span> <span class="o">/</span> <span class="n">ThreadblockShape</span><span class="p">::</span><span class="n">N</span>
    <span class="n">i</span> <span class="o">=</span> <span class="n">i_macro</span>
    <span class="n">j</span> <span class="o">=</span> <span class="p">(</span><span class="n">j_macro</span> <span class="o">*</span> <span class="n">r</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">t</span> <span class="o">%</span> <span class="n">r</span><span class="p">)</span>
<span class="k">elif</span> <span class="p">(</span><span class="n">ThreadblockShape</span><span class="p">::</span><span class="n">M</span> <span class="o">&lt;</span> <span class="n">ThreadblockShape</span><span class="p">::</span><span class="n">N</span><span class="p">):</span>
    <span class="n">r</span> <span class="o">=</span> <span class="n">ThreadblockShape</span><span class="p">::</span><span class="n">N</span> <span class="o">/</span> <span class="n">ThreadblockShape</span><span class="p">::</span><span class="n">M</span>
    <span class="n">i</span> <span class="o">=</span> <span class="p">(</span><span class="n">i_macro</span> <span class="o">*</span> <span class="n">r</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">t</span> <span class="o">%</span> <span class="n">r</span><span class="p">)</span>
    <span class="n">j</span> <span class="o">=</span> <span class="n">j_macro</span>
<span class="k">else</span><span class="p">:</span>
    <span class="n">i</span> <span class="o">=</span> <span class="n">i_macro</span>
    <span class="n">j</span> <span class="o">=</span> <span class="n">j_macro</span>
</pre></div>
</div>
</section>
<section id="handling-cases-with-grid-dimensions-that-aren-t-multiples-of-each-other">
<h3>Handling cases with grid dimensions that aren’t multiples of each other<a class="headerlink" href="#handling-cases-with-grid-dimensions-that-aren-t-multiples-of-each-other" title="Link to this heading">#</a></h3>
<p>Even though threadblock shapes M and N are typically multiples of one another, the grid
for a given problem may not have dimensions of the same ratio as that of the threadblock.
For example, a problem of size 132x132 using a threadblock of shape 64x32 will result
in a grid of 3x5 tiles. In this case, there is not an integer number of “true tiles”
per “macro tile.”</p>
<p>When this scenario arises, we simply pad the larger dimension of the grid such that
there are an integer number of “true tiles” per “macro tile.” Thus, the 3x5 grid in
the example above will be treated as a 3x6 grid. Row and column positions for each
tile are calculated as above. Any threadblocks that map to tiles that are outside the
problem range or upper/lower triangular portion (e.g., (2, 5)) will exit early from
this problem and may proceed to the next problem in the group.</p>
</section>
<section id="handling-upper-triangular-matrices">
<h3>Handling upper-triangular matrices<a class="headerlink" href="#handling-upper-triangular-matrices" title="Link to this heading">#</a></h3>
<p>The only modification needed for upper-triangular matrices is to swap <code class="docutils literal notranslate"><span class="pre">i_macro</span></code> and <code class="docutils literal notranslate"><span class="pre">j_macro</span></code> in the calculations above.</p>
</section>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="scheduler-modes">
<h1>Scheduler modes<a class="headerlink" href="#scheduler-modes" title="Link to this heading">#</a></h1>
<p>The grouped kernel schedulers come with two different modes for finding
the next tile for a block to compute. These techniques are controlled by
the <a class="reference external" href="https://github.com/NVIDIA/cutlass/tree/main/include/cutlass/gemm/kernel/grouped_problem_visitor.h"><code class="docutils literal notranslate"><span class="pre">cutlass::gemm::kernel::GroupScheduleMode</span></code></a> enum.
We describe each mode in greater detail below.</p>
<section id="groupschedulemode-kdeviceonly-default">
<h2><code class="docutils literal notranslate"><span class="pre">GroupScheduleMode::kDeviceOnly</span></code> (default)<a class="headerlink" href="#groupschedulemode-kdeviceonly-default" title="Link to this heading">#</a></h2>
<p>This scheduler mode performs all scheduling work on the device. It parallelizes
the search for the problem that <code class="docutils literal notranslate"><span class="pre">tile_idx</span></code> maps to by having each thread “own”
a different problem and determine whether <code class="docutils literal notranslate"><span class="pre">tile_idx</span></code> falls within the range of
that problem.</p>
<p><code class="docutils literal notranslate"><span class="pre">GroupScheduleMode::kDeviceOnly</span></code> performs this parallelization in a warp-wide
fashion. Each thread in the warp loads a problem size indexed by its lane id and
computes the number of tiles in that problem. A warp-wide prefix sum is used to find
the starting tiles for the set of problems the warp is looking at. At the end of the
prefix sum, each thread holds the starting tile index and tile count for a unique
problem in the group.</p>
<p>While <code class="docutils literal notranslate"><span class="pre">tile_idx</span></code> remains within the range of the problems currently hosted by the
warp, each thread will check whether <code class="docutils literal notranslate"><span class="pre">tile_idx</span></code>  is in the range of its current
problem. The matching problem index and its starting tile are then broadcasted to all
threads in the warp.</p>
</section>
<section id="precomputing-schedules-on-the-host-groupschedulemode-khostprecompute">
<h2>Precomputing schedules on the host: <code class="docutils literal notranslate"><span class="pre">GroupScheduleMode::kHostPrecompute</span></code><a class="headerlink" href="#precomputing-schedules-on-the-host-groupschedulemode-khostprecompute" title="Link to this heading">#</a></h2>
<p>This scheduler attempts to reduce the amount of scheduling performed on the device
by precomputing on the host the sequence of problems that will
be accessed by each block. As described above, all that is needed to map tile_idx  to
the specific tile within a problem to compute is the problem ID and the problem’s
starting tile (among all of the tiles in the group). Thus, this scheduler precomputes
the problem index and problem starting tile for each tile computed by each block.</p>
<p>The schedule for an individual block is represented as an array of
<code class="docutils literal notranslate"><span class="pre">(problem_idx,</span> <span class="pre">problem_starting_tile)</span></code> tuples. There is one such array per block.
These arrays are produced on the host and copied over to the device. This
representation is optimized for the case in which blocks compute at most one
tile per problem. When a block computes multiple tiles per problem in the group,
the representation above will result in duplicate entries, and thus will be
suboptimal (e.g., <code class="docutils literal notranslate"><span class="pre">[(3,</span> <span class="pre">20),</span> <span class="pre">(3,</span> <span class="pre">20)]</span></code> for a block that computes two tiles in
problem 3, which has starting tile index 20).
We have chosen to use the representation described above because grouped kernels
themselves are typically most beneficial when problem sizes are small, and, thus,
blocks compute at most one tile per problem.</p>
</section>
<section id="which-scheduler-mode-should-i-use">
<h2>Which scheduler mode should I use?<a class="headerlink" href="#which-scheduler-mode-should-i-use" title="Link to this heading">#</a></h2>
<p>Consider the following questions when deciding which scheduling mode to use:</p>
<section id="how-are-the-parameters-used-as-input-to-the-grouped-kernel-e-g-ptra-lda-set-in-my-application">
<h3>How are the parameters used as input to the grouped kernel (e.g., ptrA, lda) set in my application?<a class="headerlink" href="#how-are-the-parameters-used-as-input-to-the-grouped-kernel-e-g-ptra-lda-set-in-my-application" title="Link to this heading">#</a></h3>
<p>If these are set by a previous kernel running on
the device (rather than by the host), you likely want to use <code class="docutils literal notranslate"><span class="pre">kDeviceOnly</span></code>,
as this will minimize additional host-device communication.</p>
</section>
<section id="can-host-side-work-be-overlapped-with-other-device-kernels-in-my-application">
<h3>Can host-side work be overlapped with other device kernels in my application?<a class="headerlink" href="#can-host-side-work-be-overlapped-with-other-device-kernels-in-my-application" title="Link to this heading">#</a></h3>
<p>For example, if a grouped GEMM is used as the Nth layer in a neural network,
host-side precomputation for the grouped GEMM can potentially be overlapped
with device-side work for layer N-1. In this case <code class="docutils literal notranslate"><span class="pre">kHostPrecompute</span></code> is likely
a good fit.</p>
</section>
<section id="how-compute-intensive-are-the-problems-in-my-group">
<h3>How compute-intensive are the problems in my group?<a class="headerlink" href="#how-compute-intensive-are-the-problems-in-my-group" title="Link to this heading">#</a></h3>
<p>The differences in performance between <code class="docutils literal notranslate"><span class="pre">kHostPrecompute</span></code> and <code class="docutils literal notranslate"><span class="pre">kDeviceOnly</span></code> are most
noticeable for grouped kernels with low computational intensity, for which time spent in
the scheduler accounts for a significant fraction of the grouped kernel’s runtime.
Intuitively, as problems in a group decrease in computational intensity, a smaller
fraction of the overall runtime will be consumed in performing MMA operations, leading
to a larger fraction of the overall runtime being consumed by scheduling logic.</p>
<p>Since the scheduling modes affect only the scheduling logic of the grouped kernels,
one expects to see most benefit from <code class="docutils literal notranslate"><span class="pre">kHostPrecompute</span></code> for less computationally-intense
groups.</p>
</section>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="improving-load-balance-by-sorting-problems">
<h1>Improving Load Balance by Sorting Problems<a class="headerlink" href="#improving-load-balance-by-sorting-problems" title="Link to this heading">#</a></h1>
<p>The grouped kernel schedulers assign a nearly equal number
of tiles to each block participating in the grouped kernel. Every tile in the
group has the same M and N dimensions. However, the K dimension of each
tile depends on the K dimension of the problem, so tiles may have different
K dimensions. Thus, the K dimension of the
tile plays a significant role in determining how long it takes for a given
tile to be computed.</p>
<section id="potential-problems-with-imbalanced-k-dimension">
<h2>Potential problems with imbalanced K dimension<a class="headerlink" href="#potential-problems-with-imbalanced-k-dimension" title="Link to this heading">#</a></h2>
<p>To ensure that compute load is balanced evenly across blocks, it is important
that the sum of the K dimensions among all tiles a block computes be similar
to that of other blocks; if one block computes far more tiles with a large
value of K than other blocks, it may take longer than the other blocks.</p>
<p>For example, consider the following group of GEMMs:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">0</span> <span class="mi">1152</span><span class="n">x768x128</span>
<span class="mi">1</span> <span class="mi">1152</span><span class="n">x768x1024</span>
<span class="mi">2</span> <span class="mi">768</span><span class="n">x1152x128</span>
<span class="mi">3</span> <span class="mi">768</span><span class="n">x1152x1024</span>
</pre></div>
</div>
<p>If a tile size of 128x128 is used, then each problem will have 54 tiles.
Thus, there are 216 tiles across the group.</p>
<p>Suppose this grouped GEMM is run on GA100, which has 108 SMs. Suppose that
the occupancy given the parameters of the grouped GEMM is one – one threadblock
can be active at a time on an SM. The grouped GEMM will, thus, run with 108
persistent threadblocks, each of which computes (256 / 108) = 2 tiles.</p>
<p>Under the round-robin assignment of tiles to threadblocks employed by
the grouped GEMM scheduler, the assignment of tiles to threadblocks
in this GEMM will be as follows:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Threadblocks</span> <span class="mi">0</span><span class="o">-</span><span class="mi">53</span><span class="p">:</span>     <span class="n">Tiles</span> <span class="n">of</span> <span class="n">size</span> <span class="mi">128</span><span class="n">x128x128</span>  <span class="kn">from</span><span class="w"> </span><span class="nn">problem</span> <span class="mi">0</span>
<span class="n">Threadblocks</span> <span class="mi">54</span><span class="o">-</span><span class="mi">107</span><span class="p">:</span>   <span class="n">Tiles</span> <span class="n">of</span> <span class="n">size</span> <span class="mi">128</span><span class="n">x128x1024</span> <span class="kn">from</span><span class="w"> </span><span class="nn">problem</span> <span class="mi">1</span>
<span class="n">Threadblocks</span> <span class="mi">0</span><span class="o">-</span><span class="mi">53</span><span class="p">:</span>     <span class="n">Tiles</span> <span class="n">of</span> <span class="n">size</span> <span class="mi">128</span><span class="n">x128x128</span>  <span class="kn">from</span><span class="w"> </span><span class="nn">problem</span> <span class="mi">2</span>
<span class="n">Threadblocks</span> <span class="mi">54</span><span class="o">-</span><span class="mi">107</span><span class="p">:</span>   <span class="n">Tiles</span> <span class="n">of</span> <span class="n">size</span> <span class="mi">128</span><span class="n">x128x1024</span> <span class="kn">from</span><span class="w"> </span><span class="nn">problem</span> <span class="mi">3</span>
</pre></div>
</div>
<p>Following this assignment, threadblocks 54-107 perform significantly more
work than threadblocks 0-53 because they compute two tiles with a K
dimension of 1024, whereas threadblocks 0-53 compute two tiles with K
dimension of only 128.</p>
<p>Due to this imbalanced assignment, threadblocks 54-107 will run
significantly longer than threadblocks 0-53, leaving threadblocks
0-53 idle for a large fraction of time.</p>
<p>Clearly, a better assignment of tiles to threadblocks for this
example would involve all threadblocks computing one tile with
a K dimension of 1024 and one tile with a K dimension of 128.
This would better balance the workload among threadblocks.</p>
</section>
<section id="potential-for-sorting-problems-to-reduce-imbalance">
<h2>Potential for sorting problems to reduce imbalance<a class="headerlink" href="#potential-for-sorting-problems-to-reduce-imbalance" title="Link to this heading">#</a></h2>
<p>A simple way to potentially reduce load imbalance is to sort the problems in a group in
descending order of their K dimension. This can help to improve load balance
because tiles in a group are assigned in a round-robin fashion to blocks
sequentially, so every block will always be assigned next the tile with
the highest K dimension available.</p>
<p>Considering the example described above, sorting the problem sizes before
executing grouped GEMM improves the runtime of this grouped GEMM on GA100 with each
scheduling mode by around 30%.</p>
<p>To ease the process of sorting groups and their associated metadata in this
manner, the device-level grouped kernels provide a <code class="docutils literal notranslate"><span class="pre">sort_problems()</span></code> method.
An example of how to use this may be found in the <a class="reference external" href="https://github.com/NVIDIA/cutlass/tree/main/examples/24_gemm_grouped/gemm_grouped.cu">grouped GEMM example</a>.</p>
<p>Finally, while sorting problems can be helpful in certain scenarios, it is
not guaranteed to improve performance. In some cases, performance can
decrease when sorting problems due to additional conflicting factors that
affect GEMM performance. We recommend profiling your grouped kernel with
and without sorting to see whether it helps in your case.</p>
</section>
<section id="copyright">
<h2>Copyright<a class="headerlink" href="#copyright" title="Link to this heading">#</a></h2>
<p>Copyright (c) 2017 - 2025 NVIDIA CORPORATION &amp; AFFILIATES. All rights reserved.
SPDX-License-Identifier: BSD-3-Clause</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>  <span class="n">Redistribution</span> <span class="ow">and</span> <span class="n">use</span> <span class="ow">in</span> <span class="n">source</span> <span class="ow">and</span> <span class="n">binary</span> <span class="n">forms</span><span class="p">,</span> <span class="k">with</span> <span class="ow">or</span> <span class="n">without</span>
  <span class="n">modification</span><span class="p">,</span> <span class="n">are</span> <span class="n">permitted</span> <span class="n">provided</span> <span class="n">that</span> <span class="n">the</span> <span class="n">following</span> <span class="n">conditions</span> <span class="n">are</span> <span class="n">met</span><span class="p">:</span>

  <span class="mf">1.</span> <span class="n">Redistributions</span> <span class="n">of</span> <span class="n">source</span> <span class="n">code</span> <span class="n">must</span> <span class="n">retain</span> <span class="n">the</span> <span class="n">above</span> <span class="n">copyright</span> <span class="n">notice</span><span class="p">,</span> <span class="n">this</span>
  <span class="nb">list</span> <span class="n">of</span> <span class="n">conditions</span> <span class="ow">and</span> <span class="n">the</span> <span class="n">following</span> <span class="n">disclaimer</span><span class="o">.</span>

  <span class="mf">2.</span> <span class="n">Redistributions</span> <span class="ow">in</span> <span class="n">binary</span> <span class="n">form</span> <span class="n">must</span> <span class="n">reproduce</span> <span class="n">the</span> <span class="n">above</span> <span class="n">copyright</span> <span class="n">notice</span><span class="p">,</span>
  <span class="n">this</span> <span class="nb">list</span> <span class="n">of</span> <span class="n">conditions</span> <span class="ow">and</span> <span class="n">the</span> <span class="n">following</span> <span class="n">disclaimer</span> <span class="ow">in</span> <span class="n">the</span> <span class="n">documentation</span>
  <span class="ow">and</span><span class="o">/</span><span class="ow">or</span> <span class="n">other</span> <span class="n">materials</span> <span class="n">provided</span> <span class="k">with</span> <span class="n">the</span> <span class="n">distribution</span><span class="o">.</span>

  <span class="mf">3.</span> <span class="n">Neither</span> <span class="n">the</span> <span class="n">name</span> <span class="n">of</span> <span class="n">the</span> <span class="n">copyright</span> <span class="n">holder</span> <span class="n">nor</span> <span class="n">the</span> <span class="n">names</span> <span class="n">of</span> <span class="n">its</span>
  <span class="n">contributors</span> <span class="n">may</span> <span class="n">be</span> <span class="n">used</span> <span class="n">to</span> <span class="n">endorse</span> <span class="ow">or</span> <span class="n">promote</span> <span class="n">products</span> <span class="n">derived</span> <span class="kn">from</span>
<span class="w">  </span><span class="nn">this</span> <span class="n">software</span> <span class="n">without</span> <span class="n">specific</span> <span class="n">prior</span> <span class="n">written</span> <span class="n">permission</span><span class="o">.</span>

  <span class="n">THIS</span> <span class="n">SOFTWARE</span> <span class="n">IS</span> <span class="n">PROVIDED</span> <span class="n">BY</span> <span class="n">THE</span> <span class="n">COPYRIGHT</span> <span class="n">HOLDERS</span> <span class="n">AND</span> <span class="n">CONTRIBUTORS</span> <span class="s2">&quot;AS IS&quot;</span>
  <span class="n">AND</span> <span class="n">ANY</span> <span class="n">EXPRESS</span> <span class="n">OR</span> <span class="n">IMPLIED</span> <span class="n">WARRANTIES</span><span class="p">,</span> <span class="n">INCLUDING</span><span class="p">,</span> <span class="n">BUT</span> <span class="n">NOT</span> <span class="n">LIMITED</span> <span class="n">TO</span><span class="p">,</span> <span class="n">THE</span>
  <span class="n">IMPLIED</span> <span class="n">WARRANTIES</span> <span class="n">OF</span> <span class="n">MERCHANTABILITY</span> <span class="n">AND</span> <span class="n">FITNESS</span> <span class="n">FOR</span> <span class="n">A</span> <span class="n">PARTICULAR</span> <span class="n">PURPOSE</span> <span class="n">ARE</span>
  <span class="n">DISCLAIMED</span><span class="o">.</span> <span class="n">IN</span> <span class="n">NO</span> <span class="n">EVENT</span> <span class="n">SHALL</span> <span class="n">THE</span> <span class="n">COPYRIGHT</span> <span class="n">HOLDER</span> <span class="n">OR</span> <span class="n">CONTRIBUTORS</span> <span class="n">BE</span> <span class="n">LIABLE</span>
  <span class="n">FOR</span> <span class="n">ANY</span> <span class="n">DIRECT</span><span class="p">,</span> <span class="n">INDIRECT</span><span class="p">,</span> <span class="n">INCIDENTAL</span><span class="p">,</span> <span class="n">SPECIAL</span><span class="p">,</span> <span class="n">EXEMPLARY</span><span class="p">,</span> <span class="n">OR</span> <span class="n">CONSEQUENTIAL</span>
  <span class="n">DAMAGES</span> <span class="p">(</span><span class="n">INCLUDING</span><span class="p">,</span> <span class="n">BUT</span> <span class="n">NOT</span> <span class="n">LIMITED</span> <span class="n">TO</span><span class="p">,</span> <span class="n">PROCUREMENT</span> <span class="n">OF</span> <span class="n">SUBSTITUTE</span> <span class="n">GOODS</span> <span class="n">OR</span>
  <span class="n">SERVICES</span><span class="p">;</span> <span class="n">LOSS</span> <span class="n">OF</span> <span class="n">USE</span><span class="p">,</span> <span class="n">DATA</span><span class="p">,</span> <span class="n">OR</span> <span class="n">PROFITS</span><span class="p">;</span> <span class="n">OR</span> <span class="n">BUSINESS</span> <span class="n">INTERRUPTION</span><span class="p">)</span> <span class="n">HOWEVER</span>
  <span class="n">CAUSED</span> <span class="n">AND</span> <span class="n">ON</span> <span class="n">ANY</span> <span class="n">THEORY</span> <span class="n">OF</span> <span class="n">LIABILITY</span><span class="p">,</span> <span class="n">WHETHER</span> <span class="n">IN</span> <span class="n">CONTRACT</span><span class="p">,</span> <span class="n">STRICT</span> <span class="n">LIABILITY</span><span class="p">,</span>
  <span class="n">OR</span> <span class="n">TORT</span> <span class="p">(</span><span class="n">INCLUDING</span> <span class="n">NEGLIGENCE</span> <span class="n">OR</span> <span class="n">OTHERWISE</span><span class="p">)</span> <span class="n">ARISING</span> <span class="n">IN</span> <span class="n">ANY</span> <span class="n">WAY</span> <span class="n">OUT</span> <span class="n">OF</span> <span class="n">THE</span> <span class="n">USE</span>
  <span class="n">OF</span> <span class="n">THIS</span> <span class="n">SOFTWARE</span><span class="p">,</span> <span class="n">EVEN</span> <span class="n">IF</span> <span class="n">ADVISED</span> <span class="n">OF</span> <span class="n">THE</span> <span class="n">POSSIBILITY</span> <span class="n">OF</span> <span class="n">SUCH</span> <span class="n">DAMAGE</span><span class="o">.</span>
</pre></div>
</div>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="dependent_kernel_launch.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Dependent kernel launches</p>
      </div>
    </a>
    <a class="right-next"
       href="blackwell_functionality.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Blackwell SM100 GEMMs</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">CUTLASS Grouped Kernel Schedulers</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#introduction-to-grouped-kernel-schedulers">Introduction to Grouped Kernel Schedulers</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#grouped-gemm-scheduler">Grouped GEMM Scheduler</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#computing-the-schedule-for-a-given-block">Computing the schedule for a given block</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#grouped-rank2k-scheduler">Grouped Rank2K Scheduler</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#inefficiency-of-grouped-gemm-scheduler-for-grouped-rank2k-problems">Inefficiency of grouped GEMM scheduler for grouped Rank2K problems</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#specializing-the-scheduler-for-triangular-problems">Specializing the scheduler for triangular problems</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#calculating-row-i-given-threadblock-id-t">Calculating row <code class="docutils literal notranslate"><span class="pre">i</span></code> given threadblock ID <code class="docutils literal notranslate"><span class="pre">t</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#calculating-column-j-given-threadblock-id-t-and-row-i">Calculating column <code class="docutils literal notranslate"><span class="pre">j</span></code> given threadblock ID <code class="docutils literal notranslate"><span class="pre">t</span></code> and row <code class="docutils literal notranslate"><span class="pre">i</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#accounting-for-non-square-grids">Accounting for non-square grids</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#handling-cases-with-grid-dimensions-that-aren-t-multiples-of-each-other">Handling cases with grid dimensions that aren’t multiples of each other</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#handling-upper-triangular-matrices">Handling upper-triangular matrices</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#scheduler-modes">Scheduler modes</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#groupschedulemode-kdeviceonly-default"><code class="docutils literal notranslate"><span class="pre">GroupScheduleMode::kDeviceOnly</span></code> (default)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#precomputing-schedules-on-the-host-groupschedulemode-khostprecompute">Precomputing schedules on the host: <code class="docutils literal notranslate"><span class="pre">GroupScheduleMode::kHostPrecompute</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#which-scheduler-mode-should-i-use">Which scheduler mode should I use?</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#how-are-the-parameters-used-as-input-to-the-grouped-kernel-e-g-ptra-lda-set-in-my-application">How are the parameters used as input to the grouped kernel (e.g., ptrA, lda) set in my application?</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#can-host-side-work-be-overlapped-with-other-device-kernels-in-my-application">Can host-side work be overlapped with other device kernels in my application?</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#how-compute-intensive-are-the-problems-in-my-group">How compute-intensive are the problems in my group?</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#improving-load-balance-by-sorting-problems">Improving Load Balance by Sorting Problems</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#potential-problems-with-imbalanced-k-dimension">Potential problems with imbalanced K dimension</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#potential-for-sorting-problems-to-reduce-imbalance">Potential for sorting problems to reduce imbalance</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#copyright">Copyright</a></li>
</ul>
</li>
</ul>

  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By The Jupyter Book Community
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>
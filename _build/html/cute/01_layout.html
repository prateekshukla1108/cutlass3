
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>CuTe Layouts &#8212; My sample book</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css?v=be8a1c11" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'cute/01_layout';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="CuTe Layout Algebra" href="02_layout_algebra.html" />
    <link rel="prev" title="Getting Started With CuTe" href="00_quickstart.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../overview.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/logo.png" class="logo__image only-light" alt="My sample book - Home"/>
    <script>document.write(`<img src="../_static/logo.png" class="logo__image only-dark" alt="My sample book - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../overview.html">
                    Overview
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Getting Started</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../quickstart.html">Quickstart</a></li>



<li class="toctree-l1"><a class="reference internal" href="../terminology.html">CUTLASS Terminology</a></li>

<li class="toctree-l1"><a class="reference internal" href="../ide_setup.html">IDE Setup for CUTLASS Development</a></li>
<li class="toctree-l1"><a class="reference internal" href="../functionality.html">Functionality</a></li>

</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Core Concepts</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../fundamental_types.html">Fundamental Types</a></li>

<li class="toctree-l1"><a class="reference internal" href="../layout.html">Layouts and Tensors</a></li>



<li class="toctree-l1"><a class="reference internal" href="../tile_iterator_concept.html">Tile Iterator Concepts</a></li>

<li class="toctree-l1"><a class="reference internal" href="../pipeline.html">Synchronization primitives</a></li>

<li class="toctree-l1"><a class="reference internal" href="../code_organization.html">CUTLASS Code Organization</a></li>

<li class="toctree-l1"><a class="reference internal" href="../programming_guidelines.html">Programming Guidelines</a></li>

<li class="toctree-l1"><a class="reference internal" href="../utilities.html">CUTLASS Utilities</a></li>

</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Key Operations &amp; APIs</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../gemm_api.html">CUTLASS GEMM API</a></li>



<li class="toctree-l1"><a class="reference internal" href="../gemm_api_3x.html">CUTLASS 3.0 GEMM API</a></li>



<li class="toctree-l1"><a class="reference internal" href="../efficient_gemm.html">Efficient GEMM in CUDA</a></li>


<li class="toctree-l1"><a class="reference internal" href="../implicit_gemm_convolution.html">CUTLASS Convolution</a></li>





</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">CUTLASS 3.x Specifics</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../cutlass_3x_design.html">CUTLASS 3.0 Design</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cutlass_3x_backwards_compatibility.html">CUTLASS 3.0 GEMM Backwards Compatibility</a></li>

</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">CUTE - Compositional Universal Tile Engine</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="00_quickstart.html">Getting Started With CuTe</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">CuTe Layouts</a></li>
<li class="toctree-l1"><a class="reference internal" href="02_layout_algebra.html">CuTe Layout Algebra</a></li>
<li class="toctree-l1"><a class="reference internal" href="03_tensor.html">CuTe Tensors</a></li>
<li class="toctree-l1"><a class="reference internal" href="04_algorithms.html">CuTe Tensor algorithms</a></li>
<li class="toctree-l1"><a class="reference internal" href="0t_mma_atom.html">CuTe’s support for Matrix Multiply-Accumulate instructions</a></li>
<li class="toctree-l1"><a class="reference internal" href="0x_gemm_tutorial.html">CuTe dense matrix-matrix multiply tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="0y_predication.html">Predication: What to do when tiling isn’t perfect</a></li>
<li class="toctree-l1"><a class="reference internal" href="0z_tma_tensors.html">CuTe TMA Tensors</a></li>


</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Advanced Features &amp; Platform Specifics</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../dependent_kernel_launch.html">Dependent kernel launches</a></li>
<li class="toctree-l1"><a class="reference internal" href="../grouped_scheduler.html">CUTLASS Grouped Kernel Schedulers</a></li>





<li class="toctree-l1"><a class="reference internal" href="../blackwell_functionality.html">Blackwell SM100 GEMMs</a></li>


<li class="toctree-l1"><a class="reference internal" href="../blackwell_cluster_launch_control.html">Blackwell Cluster Launch Control</a></li>

<li class="toctree-l1"><a class="reference internal" href="../profiler.html">CUTLASS Profiler</a></li>




</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Building CUTLASS</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../build/building_in_windows_with_visual_studio.html">Building on Windows with Visual Studio</a></li>





<li class="toctree-l1"><a class="reference internal" href="../build/building_with_clang_as_host_compiler.html">Building with Clang as host compiler</a></li>


</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book/issues/new?title=Issue%20on%20page%20%2Fcute/01_layout.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/cute/01_layout.md" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.md</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>CuTe Layouts</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#fundamental-types-and-concepts">Fundamental Types and Concepts</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#integers">Integers</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#tuple">Tuple</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#inttuple">IntTuple</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#shapes-and-strides">Shapes and Strides</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#layout">Layout</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#tensor">Tensor</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#layout-creation-and-use">Layout Creation and Use</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#hierarchical-access-functions">Hierarchical access functions</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#constructing-a-layout">Constructing a Layout</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#using-a-layout">Using a Layout</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#vector-layouts">Vector Layouts</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#matrix-examples">Matrix examples</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#layout-concepts">Layout Concepts</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#layout-compatibility">Layout compatibility</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#layouts-coordinates">Layouts Coordinates</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#coordinate-mapping">Coordinate Mapping</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#index-mapping">Index Mapping</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#layout-manipulation">Layout Manipulation</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#sublayouts">Sublayouts</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#concatenation">Concatenation</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#grouping-and-flattening">Grouping and flattening</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#slicing">Slicing</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#summary">Summary</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#copyright">Copyright</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="cute-layouts">
<h1>CuTe Layouts<a class="headerlink" href="#cute-layouts" title="Link to this heading">#</a></h1>
<p>This document describes <code class="docutils literal notranslate"><span class="pre">Layout</span></code>, CuTe’s core abstraction.
Fundamentally, a <code class="docutils literal notranslate"><span class="pre">Layout</span></code> maps from coordinate space(s)
to an index space.</p>
<p><code class="docutils literal notranslate"><span class="pre">Layout</span></code>s present a common interface to multidimensional array access
that abstracts away the details of how the array’s elements are organized in memory.
This lets users write algorithms that access multidimensional arrays generically,
so that layouts can change, without users’ code needing to change. For example, a row-major MxN layout and a column-major MxN layout can be treated identically in software.</p>
<p>CuTe also provides an “algebra of <code class="docutils literal notranslate"><span class="pre">Layout</span></code>s.”
<code class="docutils literal notranslate"><span class="pre">Layout</span></code>s can be combined and manipulated
to construct more complicated layouts
and to tile layouts across other layouts.
This can help users do things like partition layouts of data over layouts of threads.</p>
<section id="fundamental-types-and-concepts">
<h2>Fundamental Types and Concepts<a class="headerlink" href="#fundamental-types-and-concepts" title="Link to this heading">#</a></h2>
<section id="integers">
<h3>Integers<a class="headerlink" href="#integers" title="Link to this heading">#</a></h3>
<p>CuTe makes great use of dynamic (known only at run-time) and static (known at compile-time) integers.</p>
<ul class="simple">
<li><p>Dynamic integers (or “run-time integers”) are just ordinary integral types like <code class="docutils literal notranslate"><span class="pre">int</span></code> or <code class="docutils literal notranslate"><span class="pre">size_t</span></code> or <code class="docutils literal notranslate"><span class="pre">uint16_t</span></code>. Anything that is accepted by <code class="docutils literal notranslate"><span class="pre">std::is_integral&lt;T&gt;</span></code> is considered a dynamic integer in CuTe.</p></li>
<li><p>Static integers (or “compile-time integers”) are instantiations of types like <code class="docutils literal notranslate"><span class="pre">std::integral_constant&lt;Value&gt;</span></code>. These types encode the value as a <code class="docutils literal notranslate"><span class="pre">static</span> <span class="pre">constexpr</span></code> member. They also support casting to their underlying dynamic types, so they can be used in expressions with dynamic integers. CuTe defines its own CUDA-compatibe static integer types <code class="docutils literal notranslate"><span class="pre">cute::C&lt;Value&gt;</span></code> along with overloaded math operators so that math on static integers results in static integers. CuTe defines shortcut aliases <code class="docutils literal notranslate"><span class="pre">Int&lt;1&gt;</span></code>, <code class="docutils literal notranslate"><span class="pre">Int&lt;2&gt;</span></code>, <code class="docutils literal notranslate"><span class="pre">Int&lt;3&gt;</span></code> and <code class="docutils literal notranslate"><span class="pre">_1</span></code>, <code class="docutils literal notranslate"><span class="pre">_2</span></code>, <code class="docutils literal notranslate"><span class="pre">_3</span></code> as conveniences, which you should see often within examples.</p></li>
</ul>
<p>CuTe attempts to handle static and dynamic integers identically. In the examples that follow, all dynamic integers could be replaced with static integers and vice versa. When we say “integer” in CuTe, we almost always mean a static OR dynamic integer.</p>
<p>CuTe provides a number of traits to work with integers.</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">cute::is_integral&lt;T&gt;</span></code>: Checks whether <code class="docutils literal notranslate"><span class="pre">T</span></code> is a static or dynamic integer type.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">cute::is_std_integral&lt;T&gt;</span></code>: Checks whether <code class="docutils literal notranslate"><span class="pre">T</span></code> is a dynamic integer type. Equivalent to <code class="docutils literal notranslate"><span class="pre">std::is_integral&lt;T&gt;</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">cute::is_static&lt;T&gt;</span></code>: Checks whether <code class="docutils literal notranslate"><span class="pre">T</span></code> is an empty type (so instantiations cannot depend on any dynamic information). Equivalent to <code class="docutils literal notranslate"><span class="pre">std::is_empty</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">cute::is_constant&lt;N,T&gt;</span></code>: Checks that <code class="docutils literal notranslate"><span class="pre">T</span></code> is a static integer AND its value is equivalent to <code class="docutils literal notranslate"><span class="pre">N</span></code>.</p></li>
</ul>
<p>See the <a class="reference external" href="https://github.com/NVIDIA/cutlass/tree/main/include/cute/numeric/integral_constant.hpp"><code class="docutils literal notranslate"><span class="pre">integral_constant</span></code> implementations</a> for more information.</p>
</section>
<section id="tuple">
<h3>Tuple<a class="headerlink" href="#tuple" title="Link to this heading">#</a></h3>
<p>A tuple is a finite ordered list of zero or more elements.
The <a class="reference external" href="https://github.com/NVIDIA/cutlass/tree/main/include/cute/container/tuple.hpp"><code class="docutils literal notranslate"><span class="pre">cute::tuple</span></code> class</a> behaves like <code class="docutils literal notranslate"><span class="pre">std::tuple</span></code>, but works on device and host. It imposes restrictions on its template arguments and strips down the implementation for performance and simplicity.</p>
</section>
<section id="inttuple">
<h3>IntTuple<a class="headerlink" href="#inttuple" title="Link to this heading">#</a></h3>
<p>CuTe defines the IntTuple concept as either an integer, or a tuple of IntTuples. Note the recursive definition.
In C++, we define <a class="reference external" href="https://github.com/NVIDIA/cutlass/tree/main/include/cute/int_tuple.hpp">operations on <code class="docutils literal notranslate"><span class="pre">IntTuple</span></code></a>.</p>
<p>Examples of <code class="docutils literal notranslate"><span class="pre">IntTuple</span></code>s include:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">int{2}</span></code>, the dynamic integer 2.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Int&lt;3&gt;{}</span></code>, the static integer 3.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">make_tuple(int{2},</span> <span class="pre">Int&lt;3&gt;{})</span></code>, the tuple of dynamic-2, and static-3.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">make_tuple(uint16_t{42},</span> <span class="pre">make_tuple(Int&lt;1&gt;{},</span> <span class="pre">int32_t{3}),</span> <span class="pre">Int&lt;17&gt;{})</span></code>, the tuple of dynamic-42, tuple of static-1 and dynamic-3, and static-17.</p></li>
</ul>
<p>CuTe reuses the <code class="docutils literal notranslate"><span class="pre">IntTuple</span></code> concept for many different things,
including Shape, Stride, Step, and Coord
(see <a class="reference external" href="https://github.com/NVIDIA/cutlass/tree/main/include/cute/layout.hpp"><code class="docutils literal notranslate"><span class="pre">include/cute/layout.hpp</span></code></a>).</p>
<p>Operations defined on <code class="docutils literal notranslate"><span class="pre">IntTuple</span></code>s include the following.</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">rank(IntTuple)</span></code>: The number of elements in an <code class="docutils literal notranslate"><span class="pre">IntTuple</span></code>. A single integer has rank 1, and a tuple has rank <code class="docutils literal notranslate"><span class="pre">tuple_size</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">get&lt;I&gt;(IntTuple)</span></code>: The <code class="docutils literal notranslate"><span class="pre">I</span></code>th element of the <code class="docutils literal notranslate"><span class="pre">IntTuple</span></code>, with <code class="docutils literal notranslate"><span class="pre">I</span> <span class="pre">&lt;</span> <span class="pre">rank</span></code>. For single integers, <code class="docutils literal notranslate"><span class="pre">get&lt;0&gt;</span></code> is just that integer.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">depth(IntTuple)</span></code>: The number of hierarchical <code class="docutils literal notranslate"><span class="pre">IntTuple</span></code>s. A single integer has depth 0, a tuple of integers has depth 1, a tuple that contains a tuple of integers has depth 2, etc.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">size(IntTuple)</span></code>: The product of all elements of the <code class="docutils literal notranslate"><span class="pre">IntTuple</span></code>.</p></li>
</ul>
<p>We write <code class="docutils literal notranslate"><span class="pre">IntTuple</span></code>s with parentheses to denote the hierarchy. For example, <code class="docutils literal notranslate"><span class="pre">6</span></code>, <code class="docutils literal notranslate"><span class="pre">(2)</span></code>, <code class="docutils literal notranslate"><span class="pre">(4,3)</span></code>, and <code class="docutils literal notranslate"><span class="pre">(3,(6,2),8)</span></code> are all <code class="docutils literal notranslate"><span class="pre">IntTuple</span></code>s.</p>
</section>
<section id="shapes-and-strides">
<h3>Shapes and Strides<a class="headerlink" href="#shapes-and-strides" title="Link to this heading">#</a></h3>
<p>Both <code class="docutils literal notranslate"><span class="pre">Shape</span></code> and <code class="docutils literal notranslate"><span class="pre">Stride</span></code> are <code class="docutils literal notranslate"><span class="pre">IntTuple</span></code> concepts.</p>
</section>
<section id="layout">
<h3>Layout<a class="headerlink" href="#layout" title="Link to this heading">#</a></h3>
<p>A <code class="docutils literal notranslate"><span class="pre">Layout</span></code> is a tuple of (<code class="docutils literal notranslate"><span class="pre">Shape</span></code>, <code class="docutils literal notranslate"><span class="pre">Stride</span></code>).
Semantically, it implements a mapping from
any coordinate within the Shape to an index via the Stride.</p>
</section>
<section id="tensor">
<h3>Tensor<a class="headerlink" href="#tensor" title="Link to this heading">#</a></h3>
<p>A <code class="docutils literal notranslate"><span class="pre">Layout</span></code> can be composed with data – e.g., a pointer or an array – to create a <code class="docutils literal notranslate"><span class="pre">Tensor</span></code>. The index generated by the <code class="docutils literal notranslate"><span class="pre">Layout</span></code> is used to subscript an iterator to retrieve the appropriate data. For details on <code class="docutils literal notranslate"><span class="pre">Tensor</span></code>, please refer to the
<a class="reference internal" href="03_tensor.html"><span class="std std-doc"><code class="docutils literal notranslate"><span class="pre">Tensor</span></code> section of the tutorial</span></a>.</p>
</section>
</section>
<section id="layout-creation-and-use">
<h2>Layout Creation and Use<a class="headerlink" href="#layout-creation-and-use" title="Link to this heading">#</a></h2>
<p>A <code class="docutils literal notranslate"><span class="pre">Layout</span></code> is a pair of <code class="docutils literal notranslate"><span class="pre">IntTuple</span></code>s: the <code class="docutils literal notranslate"><span class="pre">Shape</span></code> and the <code class="docutils literal notranslate"><span class="pre">Stride</span></code>. The first element defines the abstract <em>shape</em> of the <code class="docutils literal notranslate"><span class="pre">Layout</span></code>, and the second element defines the <em>strides</em>, which map from coordinates within the shape to the index space.</p>
<p>We define many operations on <code class="docutils literal notranslate"><span class="pre">Layout</span></code>s analogous to those defined on <code class="docutils literal notranslate"><span class="pre">IntTuple</span></code>.</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">rank(Layout)</span></code>: The number of modes in a <code class="docutils literal notranslate"><span class="pre">Layout</span></code>. Equivalent to the tuple size of the <code class="docutils literal notranslate"><span class="pre">Layout</span></code>’s shape.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">get&lt;I&gt;(Layout)</span></code>: The <code class="docutils literal notranslate"><span class="pre">I</span></code>th sub-layout of the <code class="docutils literal notranslate"><span class="pre">Layout</span></code>, with <code class="docutils literal notranslate"><span class="pre">I</span> <span class="pre">&lt;</span> <span class="pre">rank</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">depth(Layout)</span></code>: The depth of the <code class="docutils literal notranslate"><span class="pre">Layout</span></code>’s shape. A single integer has depth 0, a tuple of integers has depth 1, a tuple of tuples of integers has depth 2, etc.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">shape(Layout)</span></code>: The shape of the <code class="docutils literal notranslate"><span class="pre">Layout</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">stride(Layout)</span></code>: The stride of the <code class="docutils literal notranslate"><span class="pre">Layout</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">size(Layout)</span></code>: The size of the <code class="docutils literal notranslate"><span class="pre">Layout</span></code> function’s domain.  Equivalent to <code class="docutils literal notranslate"><span class="pre">size(shape(Layout))</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">cosize(Layout)</span></code>: The size of the <code class="docutils literal notranslate"><span class="pre">Layout</span></code> function’s codomain (not necessarily the range). Equivalent to <code class="docutils literal notranslate"><span class="pre">A(size(A)</span> <span class="pre">-</span> <span class="pre">1)</span> <span class="pre">+</span> <span class="pre">1</span></code>.</p></li>
</ul>
<section id="hierarchical-access-functions">
<h3>Hierarchical access functions<a class="headerlink" href="#hierarchical-access-functions" title="Link to this heading">#</a></h3>
<p><code class="docutils literal notranslate"><span class="pre">IntTuple</span></code>s and <code class="docutils literal notranslate"><span class="pre">Layout</span></code>s can be arbitrarily nested.
For convenience, we define versions of some of the above functions
that take a sequence of integers, instead of just one integer.
This makes it possible to access elements
inside of nested <code class="docutils literal notranslate"><span class="pre">IntTuple</span></code> or <code class="docutils literal notranslate"><span class="pre">Layout</span></code> more easily.
For example, we permit <code class="docutils literal notranslate"><span class="pre">get&lt;I...&gt;(x)</span></code>, where <code class="docutils literal notranslate"><span class="pre">I...</span></code> is a “C++ parameter pack” that denotes zero or more (integer) template arguments. These hierarchical access functions include the following.</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">get&lt;I0,I1,...,IN&gt;(x)</span> <span class="pre">:=</span> <span class="pre">get&lt;IN&gt;(...(get&lt;I1&gt;(get&lt;I0&gt;(x)))...)</span></code>. Extract the <code class="docutils literal notranslate"><span class="pre">IN</span></code>th of the … of the <code class="docutils literal notranslate"><span class="pre">I1</span></code>st of the <code class="docutils literal notranslate"><span class="pre">I0</span></code>th element of <code class="docutils literal notranslate"><span class="pre">x</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">rank&lt;I...&gt;(x)</span>&#160; <span class="pre">:=</span> <span class="pre">rank(get&lt;I...&gt;(x))</span></code>. The rank of the <code class="docutils literal notranslate"><span class="pre">I...</span></code>th element of <code class="docutils literal notranslate"><span class="pre">x</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">depth&lt;I...&gt;(x)</span> <span class="pre">:=</span> <span class="pre">depth(get&lt;I...&gt;(x))</span></code>. The depth of the <code class="docutils literal notranslate"><span class="pre">I...</span></code>th element of <code class="docutils literal notranslate"><span class="pre">x</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">shape&lt;I...&gt;(x)</span>&#160; <span class="pre">:=</span> <span class="pre">shape(get&lt;I...&gt;(x))</span></code>. The shape of the <code class="docutils literal notranslate"><span class="pre">I...</span></code>th element of <code class="docutils literal notranslate"><span class="pre">x</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">size&lt;I...&gt;(x)</span>&#160; <span class="pre">:=</span> <span class="pre">size(get&lt;I...&gt;(x))</span></code>. The size of the <code class="docutils literal notranslate"><span class="pre">I...</span></code>th element of <code class="docutils literal notranslate"><span class="pre">x</span></code>.</p></li>
</ul>
<p>In the following examples, you’ll see use of <code class="docutils literal notranslate"><span class="pre">size&lt;0&gt;</span></code> and <code class="docutils literal notranslate"><span class="pre">size&lt;1&gt;</span></code> to determine loops bounds for the 0th and 1st mode of a layout or tensor.</p>
</section>
<section id="constructing-a-layout">
<h3>Constructing a Layout<a class="headerlink" href="#constructing-a-layout" title="Link to this heading">#</a></h3>
<p>A <code class="docutils literal notranslate"><span class="pre">Layout</span></code> can be constructed in many different ways.
It can include any combination of compile-time (static) integers
or run-time (dynamic) integers.</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="n">Layout</span><span class="w"> </span><span class="n">s8</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">make_layout</span><span class="p">(</span><span class="n">Int</span><span class="o">&lt;</span><span class="mi">8</span><span class="o">&gt;</span><span class="p">{});</span>
<span class="n">Layout</span><span class="w"> </span><span class="n">d8</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">make_layout</span><span class="p">(</span><span class="mi">8</span><span class="p">);</span>

<span class="n">Layout</span><span class="w"> </span><span class="n">s2xs4</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">make_layout</span><span class="p">(</span><span class="n">make_shape</span><span class="p">(</span><span class="n">Int</span><span class="o">&lt;</span><span class="mi">2</span><span class="o">&gt;</span><span class="p">{},</span><span class="n">Int</span><span class="o">&lt;</span><span class="mi">4</span><span class="o">&gt;</span><span class="p">{}));</span>
<span class="n">Layout</span><span class="w"> </span><span class="n">s2xd4</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">make_layout</span><span class="p">(</span><span class="n">make_shape</span><span class="p">(</span><span class="n">Int</span><span class="o">&lt;</span><span class="mi">2</span><span class="o">&gt;</span><span class="p">{},</span><span class="mi">4</span><span class="p">));</span>

<span class="n">Layout</span><span class="w"> </span><span class="n">s2xd4_a</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">make_layout</span><span class="p">(</span><span class="n">make_shape</span><span class="w"> </span><span class="p">(</span><span class="n">Int</span><span class="o">&lt;</span><span class="w"> </span><span class="mi">2</span><span class="o">&gt;</span><span class="p">{},</span><span class="mi">4</span><span class="p">),</span>
<span class="w">                             </span><span class="n">make_stride</span><span class="p">(</span><span class="n">Int</span><span class="o">&lt;</span><span class="mi">12</span><span class="o">&gt;</span><span class="p">{},</span><span class="n">Int</span><span class="o">&lt;</span><span class="mi">1</span><span class="o">&gt;</span><span class="p">{}));</span>
<span class="n">Layout</span><span class="w"> </span><span class="n">s2xd4_col</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">make_layout</span><span class="p">(</span><span class="n">make_shape</span><span class="p">(</span><span class="n">Int</span><span class="o">&lt;</span><span class="mi">2</span><span class="o">&gt;</span><span class="p">{},</span><span class="mi">4</span><span class="p">),</span>
<span class="w">                               </span><span class="n">LayoutLeft</span><span class="p">{});</span>
<span class="n">Layout</span><span class="w"> </span><span class="n">s2xd4_row</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">make_layout</span><span class="p">(</span><span class="n">make_shape</span><span class="p">(</span><span class="n">Int</span><span class="o">&lt;</span><span class="mi">2</span><span class="o">&gt;</span><span class="p">{},</span><span class="mi">4</span><span class="p">),</span>
<span class="w">                               </span><span class="n">LayoutRight</span><span class="p">{});</span>

<span class="n">Layout</span><span class="w"> </span><span class="n">s2xh4</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">make_layout</span><span class="p">(</span><span class="n">make_shape</span><span class="w"> </span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="n">make_shape</span><span class="w"> </span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)),</span>
<span class="w">                           </span><span class="n">make_stride</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="n">make_stride</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">)));</span>
<span class="n">Layout</span><span class="w"> </span><span class="n">s2xh4_col</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">make_layout</span><span class="p">(</span><span class="n">shape</span><span class="p">(</span><span class="n">s2xh4</span><span class="p">),</span>
<span class="w">                               </span><span class="n">LayoutLeft</span><span class="p">{});</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">make_layout</span></code> function returns a <code class="docutils literal notranslate"><span class="pre">Layout</span></code>.
It deduces the types of the function’s arguments and returns a <code class="docutils literal notranslate"><span class="pre">Layout</span></code> with the appropriate template arguments.
Similarly, the <code class="docutils literal notranslate"><span class="pre">make_shape</span></code> and <code class="docutils literal notranslate"><span class="pre">make_stride</span></code> functions
return a <code class="docutils literal notranslate"><span class="pre">Shape</span></code> resp. <code class="docutils literal notranslate"><span class="pre">Stride</span></code>.
CuTe often uses these <code class="docutils literal notranslate"><span class="pre">make_*</span></code> functions
due to restrictions around constructor template argument deduction (CTAD) and to avoid having to repeat static or dynamic integer types.</p>
<p>When the <code class="docutils literal notranslate"><span class="pre">Stride</span></code> argument is omitted, it is generated from the provided <code class="docutils literal notranslate"><span class="pre">Shape</span></code> with <code class="docutils literal notranslate"><span class="pre">LayoutLeft</span></code> as default. The <code class="docutils literal notranslate"><span class="pre">LayoutLeft</span></code> tag constructs strides as an exclusive prefix product of the <code class="docutils literal notranslate"><span class="pre">Shape</span></code> from left to right, without regard to the <code class="docutils literal notranslate"><span class="pre">Shape</span></code>’s hierarchy. This can be considered a “generalized column-major stride generation”. The <code class="docutils literal notranslate"><span class="pre">LayoutRight</span></code> tag constructs strides as an exclusive prefix product of the <code class="docutils literal notranslate"><span class="pre">Shape</span></code> from right to left, without regard to the <code class="docutils literal notranslate"><span class="pre">Shape</span></code>’s hierarchy. For shapes of depth one, this can be considered a “row-major stride generation”, but for hierarchical shapes the resulting strides may be surprising. For example, the strides of <code class="docutils literal notranslate"><span class="pre">s2xh4</span></code> above could be generated with <code class="docutils literal notranslate"><span class="pre">LayoutRight</span></code>.</p>
<p>Calling <code class="docutils literal notranslate"><span class="pre">print</span></code> on each layout above results in the following</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">s8</span>        <span class="p">:</span>  <span class="n">_8</span><span class="p">:</span><span class="n">_1</span>
<span class="n">d8</span>        <span class="p">:</span>  <span class="mi">8</span><span class="p">:</span><span class="n">_1</span>
<span class="n">s2xs4</span>     <span class="p">:</span>  <span class="p">(</span><span class="n">_2</span><span class="p">,</span><span class="n">_4</span><span class="p">):(</span><span class="n">_1</span><span class="p">,</span><span class="n">_2</span><span class="p">)</span>
<span class="n">s2xd4</span>     <span class="p">:</span>  <span class="p">(</span><span class="n">_2</span><span class="p">,</span><span class="mi">4</span><span class="p">):(</span><span class="n">_1</span><span class="p">,</span><span class="n">_2</span><span class="p">)</span>
<span class="n">s2xd4_a</span>   <span class="p">:</span>  <span class="p">(</span><span class="n">_2</span><span class="p">,</span><span class="mi">4</span><span class="p">):(</span><span class="n">_12</span><span class="p">,</span><span class="n">_1</span><span class="p">)</span>
<span class="n">s2xd4_col</span> <span class="p">:</span>  <span class="p">(</span><span class="n">_2</span><span class="p">,</span><span class="mi">4</span><span class="p">):(</span><span class="n">_1</span><span class="p">,</span><span class="n">_2</span><span class="p">)</span>
<span class="n">s2xd4_row</span> <span class="p">:</span>  <span class="p">(</span><span class="n">_2</span><span class="p">,</span><span class="mi">4</span><span class="p">):(</span><span class="mi">4</span><span class="p">,</span><span class="n">_1</span><span class="p">)</span>
<span class="n">s2xh4</span>     <span class="p">:</span>  <span class="p">(</span><span class="mi">2</span><span class="p">,(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)):(</span><span class="mi">4</span><span class="p">,(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
<span class="n">s2xh4_col</span> <span class="p">:</span>  <span class="p">(</span><span class="mi">2</span><span class="p">,(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)):(</span><span class="n">_1</span><span class="p">,(</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">Shape:Stride</span></code> notation is used quite often for <code class="docutils literal notranslate"><span class="pre">Layout</span></code>. The <code class="docutils literal notranslate"><span class="pre">_N</span></code> notation is shorthand for a static integer while other integers are dynamic integers. Observe that both <code class="docutils literal notranslate"><span class="pre">Shape</span></code> and <code class="docutils literal notranslate"><span class="pre">Stride</span></code> may be composed of both static and dynamic integers.</p>
<p>Also note that the <code class="docutils literal notranslate"><span class="pre">Shape</span></code> and <code class="docutils literal notranslate"><span class="pre">Stride</span></code> are assumed to be <em>congruent</em>. That is, <code class="docutils literal notranslate"><span class="pre">Shape</span></code> and <code class="docutils literal notranslate"><span class="pre">Stride</span></code> have the same tuple profiles. For every integer in <code class="docutils literal notranslate"><span class="pre">Shape</span></code>, there is a corresponding integer in <code class="docutils literal notranslate"><span class="pre">Stride</span></code>. This can be asserted with</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="k">static_assert</span><span class="p">(</span><span class="n">congruent</span><span class="p">(</span><span class="n">my_shape</span><span class="p">,</span><span class="w"> </span><span class="n">my_stride</span><span class="p">));</span>
</pre></div>
</div>
</section>
<section id="using-a-layout">
<h3>Using a Layout<a class="headerlink" href="#using-a-layout" title="Link to this heading">#</a></h3>
<p>The fundamental use of a <code class="docutils literal notranslate"><span class="pre">Layout</span></code> is to map between coordinate space(s) defined by the <code class="docutils literal notranslate"><span class="pre">Shape</span></code> and an index space defined by the <code class="docutils literal notranslate"><span class="pre">Stride</span></code>. For example, to print an arbitrary rank-2 layout in a 2-D table, we can write the function</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">class</span><span class="w"> </span><span class="nc">Shape</span><span class="p">,</span><span class="w"> </span><span class="k">class</span><span class="w"> </span><span class="nc">Stride</span><span class="o">&gt;</span>
<span class="kt">void</span><span class="w"> </span><span class="n">print2D</span><span class="p">(</span><span class="n">Layout</span><span class="o">&lt;</span><span class="n">Shape</span><span class="p">,</span><span class="n">Stride</span><span class="o">&gt;</span><span class="w"> </span><span class="k">const</span><span class="o">&amp;</span><span class="w"> </span><span class="n">layout</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">  </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">m</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">m</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">size</span><span class="o">&lt;</span><span class="mi">0</span><span class="o">&gt;</span><span class="p">(</span><span class="n">layout</span><span class="p">);</span><span class="w"> </span><span class="o">++</span><span class="n">m</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">size</span><span class="o">&lt;</span><span class="mi">1</span><span class="o">&gt;</span><span class="p">(</span><span class="n">layout</span><span class="p">);</span><span class="w"> </span><span class="o">++</span><span class="n">n</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;%3d  &quot;</span><span class="p">,</span><span class="w"> </span><span class="n">layout</span><span class="p">(</span><span class="n">m</span><span class="p">,</span><span class="n">n</span><span class="p">));</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>which produces the following output for the above examples.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&gt;</span> <span class="n">print2D</span><span class="p">(</span><span class="n">s2xs4</span><span class="p">)</span>
  <span class="mi">0</span>    <span class="mi">2</span>    <span class="mi">4</span>    <span class="mi">6</span>
  <span class="mi">1</span>    <span class="mi">3</span>    <span class="mi">5</span>    <span class="mi">7</span>
<span class="o">&gt;</span> <span class="n">print2D</span><span class="p">(</span><span class="n">s2xd4_a</span><span class="p">)</span>
  <span class="mi">0</span>    <span class="mi">1</span>    <span class="mi">2</span>    <span class="mi">3</span>
 <span class="mi">12</span>   <span class="mi">13</span>   <span class="mi">14</span>   <span class="mi">15</span>
<span class="o">&gt;</span> <span class="n">print2D</span><span class="p">(</span><span class="n">s2xh4_col</span><span class="p">)</span>
  <span class="mi">0</span>    <span class="mi">2</span>    <span class="mi">4</span>    <span class="mi">6</span>
  <span class="mi">1</span>    <span class="mi">3</span>    <span class="mi">5</span>    <span class="mi">7</span>
<span class="o">&gt;</span> <span class="n">print2D</span><span class="p">(</span><span class="n">s2xh4</span><span class="p">)</span>
  <span class="mi">0</span>    <span class="mi">2</span>    <span class="mi">1</span>    <span class="mi">3</span>
  <span class="mi">4</span>    <span class="mi">6</span>    <span class="mi">5</span>    <span class="mi">7</span>
</pre></div>
</div>
<p>We can see static, dynamic, row-major, column-major, and hierarchical layouts printed here. The statement <code class="docutils literal notranslate"><span class="pre">layout(m,n)</span></code> provides the mapping of
the logical 2-D coordinate (m,n) to the 1-D index.</p>
<p>Interestingly, the <code class="docutils literal notranslate"><span class="pre">s2xh4</span></code> example isn’t row-major or column-major. Furthermore, it has three modes but is still interpreted as rank-2 and we’re using a 2-D coordinate. Specifically, <code class="docutils literal notranslate"><span class="pre">s2xh4</span></code> has a 2-D multi-mode in the second mode, but we’re still able to use a 1-D coordinate for that mode. More on this in the next section, but first we can generalize this another step. Let’s use a 1-D coordinate and treat all of the modes of each layout as a single multi-mode.  For instance, the following <code class="docutils literal notranslate"><span class="pre">print1D</span></code> function</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">class</span><span class="w"> </span><span class="nc">Shape</span><span class="p">,</span><span class="w"> </span><span class="k">class</span><span class="w"> </span><span class="nc">Stride</span><span class="o">&gt;</span>
<span class="kt">void</span><span class="w"> </span><span class="n">print1D</span><span class="p">(</span><span class="n">Layout</span><span class="o">&lt;</span><span class="n">Shape</span><span class="p">,</span><span class="n">Stride</span><span class="o">&gt;</span><span class="w"> </span><span class="k">const</span><span class="o">&amp;</span><span class="w"> </span><span class="n">layout</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">  </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">size</span><span class="p">(</span><span class="n">layout</span><span class="p">);</span><span class="w"> </span><span class="o">++</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;%3d  &quot;</span><span class="p">,</span><span class="w"> </span><span class="n">layout</span><span class="p">(</span><span class="n">i</span><span class="p">));</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>produces the following output for the above examples.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&gt;</span> <span class="n">print1D</span><span class="p">(</span><span class="n">s2xs4</span><span class="p">)</span>
  <span class="mi">0</span>    <span class="mi">1</span>    <span class="mi">2</span>    <span class="mi">3</span>    <span class="mi">4</span>    <span class="mi">5</span>    <span class="mi">6</span>    <span class="mi">7</span>
<span class="o">&gt;</span> <span class="n">print1D</span><span class="p">(</span><span class="n">s2xd4_a</span><span class="p">)</span>
  <span class="mi">0</span>   <span class="mi">12</span>    <span class="mi">1</span>   <span class="mi">13</span>    <span class="mi">2</span>   <span class="mi">14</span>    <span class="mi">3</span>   <span class="mi">15</span>
<span class="o">&gt;</span> <span class="n">print1D</span><span class="p">(</span><span class="n">s2xh4_col</span><span class="p">)</span>
  <span class="mi">0</span>    <span class="mi">1</span>    <span class="mi">2</span>    <span class="mi">3</span>    <span class="mi">4</span>    <span class="mi">5</span>    <span class="mi">6</span>    <span class="mi">7</span>
<span class="o">&gt;</span> <span class="n">print1D</span><span class="p">(</span><span class="n">s2xh4</span><span class="p">)</span>
  <span class="mi">0</span>    <span class="mi">4</span>    <span class="mi">2</span>    <span class="mi">6</span>    <span class="mi">1</span>    <span class="mi">5</span>    <span class="mi">3</span>    <span class="mi">7</span>
</pre></div>
</div>
<p>Any multi-mode of a layout, including the entire layout itself, can accept a 1-D coordinate. More on this in the following sections.</p>
<p>CuTe provides more printing utilities for visualizing Layouts. The <code class="docutils literal notranslate"><span class="pre">print_layout</span></code> function produces a formatted 2-D table of the Layout’s mapping.</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>&gt; print_layout(s2xh4)
(2,(2,2)):(4,(2,1))
      0   1   2   3
    +---+---+---+---+
 0  | 0 | 2 | 1 | 3 |
    +---+---+---+---+
 1  | 4 | 6 | 5 | 7 |
    +---+---+---+---+
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">print_latex</span></code> function generates LaTeX that can be compiled with <code class="docutils literal notranslate"><span class="pre">pdflatex</span></code> into a color-coded vector graphics image of the same 2-D table.</p>
</section>
<section id="vector-layouts">
<h3>Vector Layouts<a class="headerlink" href="#vector-layouts" title="Link to this heading">#</a></h3>
<p>We define a vector as any <code class="docutils literal notranslate"><span class="pre">Layout</span></code> with <code class="docutils literal notranslate"><span class="pre">rank</span> <span class="pre">==</span> <span class="pre">1</span></code>.
For example, the layout <code class="docutils literal notranslate"><span class="pre">8:1</span></code> can be interpreted as an 8-element vector whose indices are contiguous.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Layout</span><span class="p">:</span>  <span class="mi">8</span><span class="p">:</span><span class="mi">1</span>
<span class="n">Coord</span> <span class="p">:</span>  <span class="mi">0</span>  <span class="mi">1</span>  <span class="mi">2</span>  <span class="mi">3</span>  <span class="mi">4</span>  <span class="mi">5</span>  <span class="mi">6</span>  <span class="mi">7</span>
<span class="n">Index</span> <span class="p">:</span>  <span class="mi">0</span>  <span class="mi">1</span>  <span class="mi">2</span>  <span class="mi">3</span>  <span class="mi">4</span>  <span class="mi">5</span>  <span class="mi">6</span>  <span class="mi">7</span>
</pre></div>
</div>
<p>Similarly,
the layout <code class="docutils literal notranslate"><span class="pre">8:2</span></code> can be interpreted as an 8-element vector where the indices of the elements are strided by <code class="docutils literal notranslate"><span class="pre">2</span></code>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Layout</span><span class="p">:</span>  <span class="mi">8</span><span class="p">:</span><span class="mi">2</span>
<span class="n">Coord</span> <span class="p">:</span>  <span class="mi">0</span>  <span class="mi">1</span>  <span class="mi">2</span>  <span class="mi">3</span>  <span class="mi">4</span>  <span class="mi">5</span>  <span class="mi">6</span>  <span class="mi">7</span>
<span class="n">Index</span> <span class="p">:</span>  <span class="mi">0</span>  <span class="mi">2</span>  <span class="mi">4</span>  <span class="mi">6</span>  <span class="mi">8</span> <span class="mi">10</span> <span class="mi">12</span> <span class="mi">14</span>
</pre></div>
</div>
<p>By the above rank-1 definition, we <em>also</em> interpret layout <code class="docutils literal notranslate"><span class="pre">((4,2)):((2,1))</span></code> as a vector, since its shape is rank-1. The inner shape looks like a 4x2 row-major matrix, but the extra pair of parenthesis suggest we can interpret those two modes as a 1-D 8-element vector. The strides tell us that the first <code class="docutils literal notranslate"><span class="pre">4</span></code> elements are strided by <code class="docutils literal notranslate"><span class="pre">2</span></code> and then there are <code class="docutils literal notranslate"><span class="pre">2</span></code> of those first elements strided by <code class="docutils literal notranslate"><span class="pre">1</span></code>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Layout</span><span class="p">:</span>  <span class="p">((</span><span class="mi">4</span><span class="p">,</span><span class="mi">2</span><span class="p">)):((</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
<span class="n">Coord</span> <span class="p">:</span>  <span class="mi">0</span>  <span class="mi">1</span>  <span class="mi">2</span>  <span class="mi">3</span>  <span class="mi">4</span>  <span class="mi">5</span>  <span class="mi">6</span>  <span class="mi">7</span>
<span class="n">Index</span> <span class="p">:</span>  <span class="mi">0</span>  <span class="mi">2</span>  <span class="mi">4</span>  <span class="mi">6</span>  <span class="mi">1</span>  <span class="mi">3</span>  <span class="mi">5</span>  <span class="mi">7</span>
</pre></div>
</div>
<p>We can see the second set of <code class="docutils literal notranslate"><span class="pre">4</span></code> elements are duplicates of the first <code class="docutils literal notranslate"><span class="pre">4</span></code> with an extra stride of <code class="docutils literal notranslate"><span class="pre">1</span></code>.</p>
<p>Consider the layout <code class="docutils literal notranslate"><span class="pre">((4,2)):((1,4))</span></code>. Again, it’s <code class="docutils literal notranslate"><span class="pre">4</span></code> elements strided by <code class="docutils literal notranslate"><span class="pre">1</span></code> and then <code class="docutils literal notranslate"><span class="pre">2</span></code> of those first elements strided by <code class="docutils literal notranslate"><span class="pre">4</span></code>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Layout</span><span class="p">:</span>  <span class="p">((</span><span class="mi">4</span><span class="p">,</span><span class="mi">2</span><span class="p">)):((</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
<span class="n">Coord</span> <span class="p">:</span>  <span class="mi">0</span>  <span class="mi">1</span>  <span class="mi">2</span>  <span class="mi">3</span>  <span class="mi">4</span>  <span class="mi">5</span>  <span class="mi">6</span>  <span class="mi">7</span>
<span class="n">Index</span> <span class="p">:</span>  <span class="mi">0</span>  <span class="mi">1</span>  <span class="mi">2</span>  <span class="mi">3</span>  <span class="mi">4</span>  <span class="mi">5</span>  <span class="mi">6</span>  <span class="mi">7</span>
</pre></div>
</div>
<p>As a function from integers to integers, it’s identical to <code class="docutils literal notranslate"><span class="pre">8:1</span></code>. It’s the identity function.</p>
</section>
<section id="matrix-examples">
<h3>Matrix examples<a class="headerlink" href="#matrix-examples" title="Link to this heading">#</a></h3>
<p>Generalizing, we define a matrix as any <code class="docutils literal notranslate"><span class="pre">Layout</span></code> that is rank-2. For example,</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Shape</span> <span class="p">:</span>  <span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="n">Stride</span><span class="p">:</span>  <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span>
  <span class="mi">0</span>   <span class="mi">4</span>
  <span class="mi">1</span>   <span class="mi">5</span>
  <span class="mi">2</span>   <span class="mi">6</span>
  <span class="mi">3</span>   <span class="mi">7</span>
</pre></div>
</div>
<p>is a 4x2 column-major layout with stride-1 down the columns and stride-4 across the rows, and</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Shape</span> <span class="p">:</span>  <span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="n">Stride</span><span class="p">:</span>  <span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
  <span class="mi">0</span>   <span class="mi">1</span>
  <span class="mi">2</span>   <span class="mi">3</span>
  <span class="mi">4</span>   <span class="mi">5</span>
  <span class="mi">6</span>   <span class="mi">7</span>
</pre></div>
</div>
<p>is a 4x2 row-major layout with stride-2 down the columns and stride-1 across the rows. Majorness is simply which mode has stride-1.</p>
<p>Just like the vector layouts, each of the modes of the matrix can also be split into <em>multi-modes</em>.
This lets us express more layouts beyond just row-major and column-major. For example,</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Shape</span><span class="p">:</span>  <span class="p">((</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span><span class="mi">2</span><span class="p">)</span>
<span class="n">Stride</span><span class="p">:</span> <span class="p">((</span><span class="mi">4</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="mi">2</span><span class="p">)</span>
  <span class="mi">0</span>   <span class="mi">2</span>
  <span class="mi">4</span>   <span class="mi">6</span>
  <span class="mi">1</span>   <span class="mi">3</span>
  <span class="mi">5</span>   <span class="mi">7</span>
</pre></div>
</div>
<p>is also logically 4x2, with stride-2 across the rows but a multi-stride down the columns. The first <code class="docutils literal notranslate"><span class="pre">2</span></code> elements down the column have a stride of <code class="docutils literal notranslate"><span class="pre">4</span></code> and then there is a copy of those with stride-1. Since this layout is logically 4x2,
like the column-major and row-major examples above,
we can <em>still</em> use 2-D coordinates to index into it.</p>
</section>
</section>
<section id="layout-concepts">
<h2>Layout Concepts<a class="headerlink" href="#layout-concepts" title="Link to this heading">#</a></h2>
<p>In this section, we’ll introduce the coordinate sets that <code class="docutils literal notranslate"><span class="pre">Layout</span></code>s accept and how the coordinate mappings and index mappings are computed.</p>
<section id="layout-compatibility">
<h3>Layout compatibility<a class="headerlink" href="#layout-compatibility" title="Link to this heading">#</a></h3>
<p>We say that layout A is <em>compatible</em> with layout B if the shape of A is compatible with the shape of B.
Shape A is compatible with shape B if</p>
<ul class="simple">
<li><p>the size of A is equal to the size of B and</p></li>
<li><p>all coordinates within A are valid coordinates within B.</p></li>
</ul>
<p>For example:</p>
<ul class="simple">
<li><p>Shape 24 is NOT compatible with Shape 32.</p></li>
<li><p>Shape 24 is compatible with Shape (4,6).</p></li>
<li><p>Shape (4,6) is compatible with Shape ((2,2),6).</p></li>
<li><p>Shape ((2,2),6) is compatible with Shape ((2,2),(3,2)).</p></li>
<li><p>Shape 24 is compatible with Shape ((2,2),(3,2)).</p></li>
<li><p>Shape 24 is compatible with Shape ((2,3),4).</p></li>
<li><p>Shape ((2,3),4) is NOT compatible with Shape ((2,2),(3,2)).</p></li>
<li><p>Shape ((2,2),(3,2)) is NOT compatible with Shape ((2,3),4).</p></li>
<li><p>Shape 24 is compatible with Shape (24).</p></li>
<li><p>Shape (24) is NOT compatible with Shape 24.</p></li>
<li><p>Shape (24) is NOT compatible with Shape (4,6).</p></li>
</ul>
<p>That is, <em>compatible</em> is a weak partial order on Shapes as it is reflexive, antisymmetric, and transitive.</p>
</section>
<section id="layouts-coordinates">
<h3>Layouts Coordinates<a class="headerlink" href="#layouts-coordinates" title="Link to this heading">#</a></h3>
<p>With the notion of compatibility above, we emphasize that every <code class="docutils literal notranslate"><span class="pre">Layout</span></code> accepts multiple kinds of coordinates. Every <code class="docutils literal notranslate"><span class="pre">Layout</span></code> accepts coordinates for any <code class="docutils literal notranslate"><span class="pre">Shape</span></code> that is compatible with it. CuTe provides mappings between these sets of coordinates via a colexicographical order.</p>
<p>Thus, all Layouts provide two fundamental mappings:</p>
<ul class="simple">
<li><p>the map from an input coordinate to the corresponding natural coordinate via the <code class="docutils literal notranslate"><span class="pre">Shape</span></code>, and</p></li>
<li><p>the map from a natural coordinate to the index via the <code class="docutils literal notranslate"><span class="pre">Stride</span></code>.</p></li>
</ul>
<section id="coordinate-mapping">
<h4>Coordinate Mapping<a class="headerlink" href="#coordinate-mapping" title="Link to this heading">#</a></h4>
<p>The map from an input coordinate to a natural coordinate is the application of a colexicographical order (reading right to left, instead of “lexicographical,” which reads left to right) within the <code class="docutils literal notranslate"><span class="pre">Shape</span></code>.</p>
<p>Take the shape <code class="docutils literal notranslate"><span class="pre">(3,(2,3))</span></code>, for example. This shape has three coordinate sets: the 1-D coordinates, the 2-D coordinates, and the natural (h-D) coordinates.</p>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>1-D</p></th>
<th class="head"><p>2-D</p></th>
<th class="head"><p>Natural</p></th>
<th class="head"><p></p></th>
<th class="head"><p>1-D</p></th>
<th class="head"><p>2-D</p></th>
<th class="head"><p>Natural</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">0</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">(0,0)</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">(0,(0,0))</span></code></p></td>
<td><p></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">9</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">(0,3)</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">(0,(1,1))</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">1</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">(1,0)</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">(1,(0,0))</span></code></p></td>
<td><p></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">10</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">(1,3)</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">(1,(1,1))</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">2</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">(2,0)</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">(2,(0,0))</span></code></p></td>
<td><p></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">11</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">(2,3)</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">(2,(1,1))</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">3</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">(0,1)</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">(0,(1,0))</span></code></p></td>
<td><p></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">12</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">(0,4)</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">(0,(0,2))</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">4</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">(1,1)</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">(1,(1,0))</span></code></p></td>
<td><p></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">13</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">(1,4)</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">(1,(0,2))</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">5</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">(2,1)</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">(2,(1,0))</span></code></p></td>
<td><p></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">14</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">(2,4)</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">(2,(0,2))</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">6</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">(0,2)</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">(0,(0,1))</span></code></p></td>
<td><p></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">15</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">(0,5)</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">(0,(1,2))</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">7</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">(1,2)</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">(1,(0,1))</span></code></p></td>
<td><p></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">16</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">(1,5)</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">(1,(1,2))</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">8</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">(2,2)</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">(2,(0,1))</span></code></p></td>
<td><p></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">17</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">(2,5)</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">(2,(1,2))</span></code></p></td>
</tr>
</tbody>
</table>
</div>
<p>Each coordinate into the shape <code class="docutils literal notranslate"><span class="pre">(3,(2,3))</span></code> has two <em>equivalent</em> coordinates and all equivalent coordinates map to the same natural coordinate. To emphasize again, because all of the above coordinates are valid inputs, a Layout with Shape <code class="docutils literal notranslate"><span class="pre">(3,(2,3))</span></code> can be used as if it is a 1-D array of 18 elements by using the 1-D coordinates, a 2-D matrix of 3x6 elements by using the 2-D coordinates, or a h-D tensor of 3x(2x3) elements by using the h-D (natural) coordinates.</p>
<p>The previous 1-D print demonstrates how CuTe identifies 1-D coordinates with a colexicographical ordering of 2-D coordinates.  Iterating from <code class="docutils literal notranslate"><span class="pre">i</span> <span class="pre">=</span> <span class="pre">0</span></code> to <code class="docutils literal notranslate"><span class="pre">size(layout)</span></code> and indexing into our layout with the single integer coordinate <code class="docutils literal notranslate"><span class="pre">i</span></code>, traverses the 2-D coordinates in this “generalized-column-major” order, even if the layout maps coordinates to indices in a row-major or more complex fashion.</p>
<p>The function <code class="docutils literal notranslate"><span class="pre">cute::idx2crd(idx,</span> <span class="pre">shape)</span></code> is responsible for the coordinate mapping. It will take any coordinate within the shape and compute the equivalent natural coordinate for that shape.</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="k">auto</span><span class="w"> </span><span class="n">shape</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Shape</span><span class="o">&lt;</span><span class="n">_3</span><span class="p">,</span><span class="n">Shape</span><span class="o">&lt;</span><span class="n">_2</span><span class="p">,</span><span class="n">_3</span><span class="o">&gt;&gt;</span><span class="p">{};</span>
<span class="n">print</span><span class="p">(</span><span class="n">idx2crd</span><span class="p">(</span><span class="w">   </span><span class="mi">16</span><span class="p">,</span><span class="w"> </span><span class="n">shape</span><span class="p">));</span><span class="w">                                </span><span class="c1">// (1,(1,2))</span>
<span class="n">print</span><span class="p">(</span><span class="n">idx2crd</span><span class="p">(</span><span class="n">_16</span><span class="p">{},</span><span class="w"> </span><span class="n">shape</span><span class="p">));</span><span class="w">                                </span><span class="c1">// (_1,(_1,_2))</span>
<span class="n">print</span><span class="p">(</span><span class="n">idx2crd</span><span class="p">(</span><span class="n">make_coord</span><span class="p">(</span><span class="w">   </span><span class="mi">1</span><span class="p">,</span><span class="mi">5</span><span class="p">),</span><span class="w"> </span><span class="n">shape</span><span class="p">));</span><span class="w">                   </span><span class="c1">// (1,(1,2))</span>
<span class="n">print</span><span class="p">(</span><span class="n">idx2crd</span><span class="p">(</span><span class="n">make_coord</span><span class="p">(</span><span class="n">_1</span><span class="p">{},</span><span class="mi">5</span><span class="p">),</span><span class="w"> </span><span class="n">shape</span><span class="p">));</span><span class="w">                   </span><span class="c1">// (_1,(1,2))</span>
<span class="n">print</span><span class="p">(</span><span class="n">idx2crd</span><span class="p">(</span><span class="n">make_coord</span><span class="p">(</span><span class="w">   </span><span class="mi">1</span><span class="p">,</span><span class="n">make_coord</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w">   </span><span class="mi">2</span><span class="p">)),</span><span class="w"> </span><span class="n">shape</span><span class="p">));</span><span class="w">  </span><span class="c1">// (1,(1,2))</span>
<span class="n">print</span><span class="p">(</span><span class="n">idx2crd</span><span class="p">(</span><span class="n">make_coord</span><span class="p">(</span><span class="n">_1</span><span class="p">{},</span><span class="n">make_coord</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">_2</span><span class="p">{})),</span><span class="w"> </span><span class="n">shape</span><span class="p">));</span><span class="w">  </span><span class="c1">// (_1,(1,_2))</span>
</pre></div>
</div>
</section>
<section id="index-mapping">
<h4>Index Mapping<a class="headerlink" href="#index-mapping" title="Link to this heading">#</a></h4>
<p>The map from a natural coordinate to an index is performed by taking the inner product of the natural coordinate with the <code class="docutils literal notranslate"><span class="pre">Layout</span></code>’s <code class="docutils literal notranslate"><span class="pre">Stride</span></code>.</p>
<p>Take the layout <code class="docutils literal notranslate"><span class="pre">(3,(2,3)):(3,(12,1))</span></code>, for example. Then a natural coordinate <code class="docutils literal notranslate"><span class="pre">(i,(j,k))</span></code> will result in the index <code class="docutils literal notranslate"><span class="pre">i*3</span> <span class="pre">+</span> <span class="pre">j*12</span> <span class="pre">+</span> <span class="pre">k*1</span></code>. The indices this layout computes are shown in the 2-D table below where <code class="docutils literal notranslate"><span class="pre">i</span></code> is used as the row coordinate and <code class="docutils literal notranslate"><span class="pre">(j,k)</span></code> is used as the column coordinate.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>       <span class="mi">0</span>     <span class="mi">1</span>     <span class="mi">2</span>     <span class="mi">3</span>     <span class="mi">4</span>     <span class="mi">5</span>     <span class="o">&lt;==</span> <span class="mi">1</span><span class="o">-</span><span class="n">D</span> <span class="n">col</span> <span class="n">coord</span>
     <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>   <span class="o">&lt;==</span> <span class="mi">2</span><span class="o">-</span><span class="n">D</span> <span class="n">col</span> <span class="n">coord</span> <span class="p">(</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">)</span>
    <span class="o">+-----+-----+-----+-----+-----+-----+</span>
 <span class="mi">0</span>  <span class="o">|</span>  <span class="mi">0</span>  <span class="o">|</span>  <span class="mi">12</span> <span class="o">|</span>  <span class="mi">1</span>  <span class="o">|</span>  <span class="mi">13</span> <span class="o">|</span>  <span class="mi">2</span>  <span class="o">|</span>  <span class="mi">14</span> <span class="o">|</span>
    <span class="o">+-----+-----+-----+-----+-----+-----+</span>
 <span class="mi">1</span>  <span class="o">|</span>  <span class="mi">3</span>  <span class="o">|</span>  <span class="mi">15</span> <span class="o">|</span>  <span class="mi">4</span>  <span class="o">|</span>  <span class="mi">16</span> <span class="o">|</span>  <span class="mi">5</span>  <span class="o">|</span>  <span class="mi">17</span> <span class="o">|</span>
    <span class="o">+-----+-----+-----+-----+-----+-----+</span>
 <span class="mi">2</span>  <span class="o">|</span>  <span class="mi">6</span>  <span class="o">|</span>  <span class="mi">18</span> <span class="o">|</span>  <span class="mi">7</span>  <span class="o">|</span>  <span class="mi">19</span> <span class="o">|</span>  <span class="mi">8</span>  <span class="o">|</span>  <span class="mi">20</span> <span class="o">|</span>
    <span class="o">+-----+-----+-----+-----+-----+-----+</span>
</pre></div>
</div>
<p>The function <code class="docutils literal notranslate"><span class="pre">cute::crd2idx(c,</span> <span class="pre">shape,</span> <span class="pre">stride)</span></code> is responsible for the index mapping. It will take any coordinate within the shape, compute the equivalent natural coordinate for that shape (if it is not already), and compute the inner product with the strides.</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="k">auto</span><span class="w"> </span><span class="n">shape</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="n">Shape</span><span class="w"> </span><span class="o">&lt;</span><span class="n">_3</span><span class="p">,</span><span class="n">Shape</span><span class="o">&lt;</span><span class="w">  </span><span class="n">_2</span><span class="p">,</span><span class="n">_3</span><span class="o">&gt;&gt;</span><span class="p">{};</span>
<span class="k">auto</span><span class="w"> </span><span class="n">stride</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Stride</span><span class="o">&lt;</span><span class="n">_3</span><span class="p">,</span><span class="n">Stride</span><span class="o">&lt;</span><span class="n">_12</span><span class="p">,</span><span class="n">_1</span><span class="o">&gt;&gt;</span><span class="p">{};</span>
<span class="n">print</span><span class="p">(</span><span class="n">crd2idx</span><span class="p">(</span><span class="w">   </span><span class="mi">16</span><span class="p">,</span><span class="w"> </span><span class="n">shape</span><span class="p">,</span><span class="w"> </span><span class="n">stride</span><span class="p">));</span><span class="w">       </span><span class="c1">// 17</span>
<span class="n">print</span><span class="p">(</span><span class="n">crd2idx</span><span class="p">(</span><span class="n">_16</span><span class="p">{},</span><span class="w"> </span><span class="n">shape</span><span class="p">,</span><span class="w"> </span><span class="n">stride</span><span class="p">));</span><span class="w">       </span><span class="c1">// _17</span>
<span class="n">print</span><span class="p">(</span><span class="n">crd2idx</span><span class="p">(</span><span class="n">make_coord</span><span class="p">(</span><span class="w">   </span><span class="mi">1</span><span class="p">,</span><span class="w">   </span><span class="mi">5</span><span class="p">),</span><span class="w"> </span><span class="n">shape</span><span class="p">,</span><span class="w"> </span><span class="n">stride</span><span class="p">));</span><span class="w">  </span><span class="c1">// 17</span>
<span class="n">print</span><span class="p">(</span><span class="n">crd2idx</span><span class="p">(</span><span class="n">make_coord</span><span class="p">(</span><span class="n">_1</span><span class="p">{},</span><span class="w">   </span><span class="mi">5</span><span class="p">),</span><span class="w"> </span><span class="n">shape</span><span class="p">,</span><span class="w"> </span><span class="n">stride</span><span class="p">));</span><span class="w">  </span><span class="c1">// 17</span>
<span class="n">print</span><span class="p">(</span><span class="n">crd2idx</span><span class="p">(</span><span class="n">make_coord</span><span class="p">(</span><span class="n">_1</span><span class="p">{},</span><span class="n">_5</span><span class="p">{}),</span><span class="w"> </span><span class="n">shape</span><span class="p">,</span><span class="w"> </span><span class="n">stride</span><span class="p">));</span><span class="w">  </span><span class="c1">// _17</span>
<span class="n">print</span><span class="p">(</span><span class="n">crd2idx</span><span class="p">(</span><span class="n">make_coord</span><span class="p">(</span><span class="w">   </span><span class="mi">1</span><span class="p">,</span><span class="n">make_coord</span><span class="p">(</span><span class="w">   </span><span class="mi">1</span><span class="p">,</span><span class="w">   </span><span class="mi">2</span><span class="p">)),</span><span class="w"> </span><span class="n">shape</span><span class="p">,</span><span class="w"> </span><span class="n">stride</span><span class="p">));</span><span class="w">  </span><span class="c1">// 17</span>
<span class="n">print</span><span class="p">(</span><span class="n">crd2idx</span><span class="p">(</span><span class="n">make_coord</span><span class="p">(</span><span class="n">_1</span><span class="p">{},</span><span class="n">make_coord</span><span class="p">(</span><span class="n">_1</span><span class="p">{},</span><span class="n">_2</span><span class="p">{})),</span><span class="w"> </span><span class="n">shape</span><span class="p">,</span><span class="w"> </span><span class="n">stride</span><span class="p">));</span><span class="w">  </span><span class="c1">// _17</span>
</pre></div>
</div>
</section>
</section>
</section>
<section id="layout-manipulation">
<h2>Layout Manipulation<a class="headerlink" href="#layout-manipulation" title="Link to this heading">#</a></h2>
<section id="sublayouts">
<h3>Sublayouts<a class="headerlink" href="#sublayouts" title="Link to this heading">#</a></h3>
<p>Sublayouts can be retrieved with <code class="docutils literal notranslate"><span class="pre">layout&lt;I...&gt;</span></code></p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">Layout</span><span class="w"> </span><span class="n">a</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="n">Layout</span><span class="o">&lt;</span><span class="n">Shape</span><span class="o">&lt;</span><span class="n">_4</span><span class="p">,</span><span class="n">Shape</span><span class="o">&lt;</span><span class="n">_3</span><span class="p">,</span><span class="n">_6</span><span class="o">&gt;&gt;&gt;</span><span class="p">{};</span><span class="w"> </span><span class="c1">// (4,(3,6)):(1,(4,12))</span>
<span class="n">Layout</span><span class="w"> </span><span class="n">a0</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="n">layout</span><span class="o">&lt;</span><span class="mi">0</span><span class="o">&gt;</span><span class="p">(</span><span class="n">a</span><span class="p">);</span><span class="w">                     </span><span class="c1">// 4:1</span>
<span class="n">Layout</span><span class="w"> </span><span class="n">a1</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="n">layout</span><span class="o">&lt;</span><span class="mi">1</span><span class="o">&gt;</span><span class="p">(</span><span class="n">a</span><span class="p">);</span><span class="w">                     </span><span class="c1">// (3,6):(4,12)</span>
<span class="n">Layout</span><span class="w"> </span><span class="n">a10</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">layout</span><span class="o">&lt;</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="o">&gt;</span><span class="p">(</span><span class="n">a</span><span class="p">);</span><span class="w">                   </span><span class="c1">// 3:4</span>
<span class="n">Layout</span><span class="w"> </span><span class="n">a11</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">layout</span><span class="o">&lt;</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="o">&gt;</span><span class="p">(</span><span class="n">a</span><span class="p">);</span><span class="w">                   </span><span class="c1">// 6:12</span>
</pre></div>
</div>
<p>or <code class="docutils literal notranslate"><span class="pre">select&lt;I...&gt;</span></code></p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">Layout</span><span class="w"> </span><span class="n">a</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="n">Layout</span><span class="o">&lt;</span><span class="n">Shape</span><span class="o">&lt;</span><span class="n">_2</span><span class="p">,</span><span class="n">_3</span><span class="p">,</span><span class="n">_5</span><span class="p">,</span><span class="n">_7</span><span class="o">&gt;&gt;</span><span class="p">{};</span><span class="w">     </span><span class="c1">// (2,3,5,7):(1,2,6,30)</span>
<span class="n">Layout</span><span class="w"> </span><span class="n">a13</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">select</span><span class="o">&lt;</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="o">&gt;</span><span class="p">(</span><span class="n">a</span><span class="p">);</span><span class="w">                   </span><span class="c1">// (3,7):(2,30)</span>
<span class="n">Layout</span><span class="w"> </span><span class="n">a01</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">select</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="o">&gt;</span><span class="p">(</span><span class="n">a</span><span class="p">);</span><span class="w">                 </span><span class="c1">// (2,3,7):(1,2,30)</span>
<span class="n">Layout</span><span class="w"> </span><span class="n">a2</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="n">select</span><span class="o">&lt;</span><span class="mi">2</span><span class="o">&gt;</span><span class="p">(</span><span class="n">a</span><span class="p">);</span><span class="w">                     </span><span class="c1">// (5):(6)</span>
</pre></div>
</div>
<p>or <code class="docutils literal notranslate"><span class="pre">take&lt;ModeBegin,</span> <span class="pre">ModeEnd&gt;</span></code></p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">Layout</span><span class="w"> </span><span class="n">a</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="n">Layout</span><span class="o">&lt;</span><span class="n">Shape</span><span class="o">&lt;</span><span class="n">_2</span><span class="p">,</span><span class="n">_3</span><span class="p">,</span><span class="n">_5</span><span class="p">,</span><span class="n">_7</span><span class="o">&gt;&gt;</span><span class="p">{};</span><span class="w">     </span><span class="c1">// (2,3,5,7):(1,2,6,30)</span>
<span class="n">Layout</span><span class="w"> </span><span class="n">a13</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">take</span><span class="o">&lt;</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="o">&gt;</span><span class="p">(</span><span class="n">a</span><span class="p">);</span><span class="w">                     </span><span class="c1">// (3,5):(2,6)</span>
<span class="n">Layout</span><span class="w"> </span><span class="n">a14</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">take</span><span class="o">&lt;</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="o">&gt;</span><span class="p">(</span><span class="n">a</span><span class="p">);</span><span class="w">                     </span><span class="c1">// (3,5,7):(2,6,30)</span>
<span class="c1">// take&lt;1,1&gt; not allowed. Empty layouts not allowed.</span>
</pre></div>
</div>
</section>
<section id="concatenation">
<h3>Concatenation<a class="headerlink" href="#concatenation" title="Link to this heading">#</a></h3>
<p>A <code class="docutils literal notranslate"><span class="pre">Layout</span></code> can be provided to <code class="docutils literal notranslate"><span class="pre">make_layout</span></code> to wrap and concatenate</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">Layout</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Layout</span><span class="o">&lt;</span><span class="n">_3</span><span class="p">,</span><span class="n">_1</span><span class="o">&gt;</span><span class="p">{};</span><span class="w">                     </span><span class="c1">// 3:1</span>
<span class="n">Layout</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Layout</span><span class="o">&lt;</span><span class="n">_4</span><span class="p">,</span><span class="n">_3</span><span class="o">&gt;</span><span class="p">{};</span><span class="w">                     </span><span class="c1">// 4:3</span>
<span class="n">Layout</span><span class="w"> </span><span class="n">row</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">make_layout</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="n">b</span><span class="p">);</span><span class="w">                 </span><span class="c1">// (3,4):(1,3)</span>
<span class="n">Layout</span><span class="w"> </span><span class="n">col</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">make_layout</span><span class="p">(</span><span class="n">b</span><span class="p">,</span><span class="w"> </span><span class="n">a</span><span class="p">);</span><span class="w">                 </span><span class="c1">// (4,3):(3,1)</span>
<span class="n">Layout</span><span class="w"> </span><span class="n">q</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="n">make_layout</span><span class="p">(</span><span class="n">row</span><span class="p">,</span><span class="w"> </span><span class="n">col</span><span class="p">);</span><span class="w">             </span><span class="c1">// ((3,4),(4,3)):((1,3),(3,1))</span>
<span class="n">Layout</span><span class="w"> </span><span class="n">aa</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="n">make_layout</span><span class="p">(</span><span class="n">a</span><span class="p">);</span><span class="w">                    </span><span class="c1">// (3):(1)</span>
<span class="n">Layout</span><span class="w"> </span><span class="n">aaa</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">make_layout</span><span class="p">(</span><span class="n">aa</span><span class="p">);</span><span class="w">                   </span><span class="c1">// ((3)):((1))</span>
<span class="n">Layout</span><span class="w"> </span><span class="n">d</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="n">make_layout</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="n">make_layout</span><span class="p">(</span><span class="n">a</span><span class="p">),</span><span class="w"> </span><span class="n">a</span><span class="p">);</span><span class="w"> </span><span class="c1">// (3,(3),3):(1,(1),1)</span>
</pre></div>
</div>
<p>or can be combined with <code class="docutils literal notranslate"><span class="pre">append</span></code>, <code class="docutils literal notranslate"><span class="pre">prepend</span></code>, or <code class="docutils literal notranslate"><span class="pre">replace</span></code>.</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">Layout</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Layout</span><span class="o">&lt;</span><span class="n">_3</span><span class="p">,</span><span class="n">_1</span><span class="o">&gt;</span><span class="p">{};</span><span class="w">                     </span><span class="c1">// 3:1</span>
<span class="n">Layout</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Layout</span><span class="o">&lt;</span><span class="n">_4</span><span class="p">,</span><span class="n">_3</span><span class="o">&gt;</span><span class="p">{};</span><span class="w">                     </span><span class="c1">// 4:3</span>
<span class="n">Layout</span><span class="w"> </span><span class="n">ab</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">append</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="n">b</span><span class="p">);</span><span class="w">                       </span><span class="c1">// (3,4):(1,3)</span>
<span class="n">Layout</span><span class="w"> </span><span class="n">ba</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">prepend</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="n">b</span><span class="p">);</span><span class="w">                      </span><span class="c1">// (4,3):(3,1)</span>
<span class="n">Layout</span><span class="w"> </span><span class="n">c</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="n">append</span><span class="p">(</span><span class="n">ab</span><span class="p">,</span><span class="w"> </span><span class="n">ab</span><span class="p">);</span><span class="w">                     </span><span class="c1">// (3,4,(3,4)):(1,3,(1,3))</span>
<span class="n">Layout</span><span class="w"> </span><span class="n">d</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="n">replace</span><span class="o">&lt;</span><span class="mi">2</span><span class="o">&gt;</span><span class="p">(</span><span class="n">c</span><span class="p">,</span><span class="w"> </span><span class="n">b</span><span class="p">);</span><span class="w">                   </span><span class="c1">// (3,4,4):(1,3,3)</span>
</pre></div>
</div>
</section>
<section id="grouping-and-flattening">
<h3>Grouping and flattening<a class="headerlink" href="#grouping-and-flattening" title="Link to this heading">#</a></h3>
<p>Layout modes can be grouped with <code class="docutils literal notranslate"><span class="pre">group&lt;ModeBegin,</span> <span class="pre">ModeEnd&gt;</span></code> and flattened with <code class="docutils literal notranslate"><span class="pre">flatten</span></code>.</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">Layout</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Layout</span><span class="o">&lt;</span><span class="n">Shape</span><span class="o">&lt;</span><span class="n">_2</span><span class="p">,</span><span class="n">_3</span><span class="p">,</span><span class="n">_5</span><span class="p">,</span><span class="n">_7</span><span class="o">&gt;&gt;</span><span class="p">{};</span><span class="w">  </span><span class="c1">// (_2,_3,_5,_7):(_1,_2,_6,_30)</span>
<span class="n">Layout</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">group</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="o">&gt;</span><span class="p">(</span><span class="n">a</span><span class="p">);</span><span class="w">                 </span><span class="c1">// ((_2,_3),_5,_7):((_1,_2),_6,_30)</span>
<span class="n">Layout</span><span class="w"> </span><span class="n">c</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">group</span><span class="o">&lt;</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="o">&gt;</span><span class="p">(</span><span class="n">b</span><span class="p">);</span><span class="w">                 </span><span class="c1">// ((_2,_3),(_5,_7)):((_1,_2),(_6,_30))</span>
<span class="n">Layout</span><span class="w"> </span><span class="n">f</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">flatten</span><span class="p">(</span><span class="n">b</span><span class="p">);</span><span class="w">                    </span><span class="c1">// (_2,_3,_5,_7):(_1,_2,_6,_30)</span>
<span class="n">Layout</span><span class="w"> </span><span class="n">e</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">flatten</span><span class="p">(</span><span class="n">c</span><span class="p">);</span><span class="w">                    </span><span class="c1">// (_2,_3,_5,_7):(_1,_2,_6,_30)</span>
</pre></div>
</div>
<p>Grouping, flattening, and reordering modes allows the reinterpretation of tensors in place as matrices, matrices as vectors, vectors as matrices, etc.</p>
</section>
<section id="slicing">
<h3>Slicing<a class="headerlink" href="#slicing" title="Link to this heading">#</a></h3>
<p><code class="docutils literal notranslate"><span class="pre">Layout</span></code>s can be sliced, but slicing is more appropriate to perform on <code class="docutils literal notranslate"><span class="pre">Tensor</span></code>s. See the <a class="reference internal" href="03_tensor.html"><span class="std std-doc"><code class="docutils literal notranslate"><span class="pre">Tensor</span></code> section</span></a> for slicing details.</p>
</section>
</section>
<section id="summary">
<h2>Summary<a class="headerlink" href="#summary" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>The <code class="docutils literal notranslate"><span class="pre">Shape</span></code> of a <code class="docutils literal notranslate"><span class="pre">Layout</span></code> defines its coordinate space(s).</p>
<ul>
<li><p>Every <code class="docutils literal notranslate"><span class="pre">Layout</span></code> has a 1-D coordinate space.
This can be used to iterate over the coordinate spaces in a colexicographical order.</p></li>
<li><p>Every <code class="docutils literal notranslate"><span class="pre">Layout</span></code> has a R-D coordinate space,
where R is the rank of the layout.
The colexicographical enumeration of the R-D coordinates
correspond to the 1-D coordinates above.</p></li>
<li><p>Every <code class="docutils literal notranslate"><span class="pre">Layout</span></code> has an h-D (natural) coordinate space where h is “hierarchical.” These are ordered colexicographically and the enumeration of that order corresponds to the 1-D coordinates above. A natural coordinate is <em>congruent</em> to the <code class="docutils literal notranslate"><span class="pre">Shape</span></code> so that each element of the coordinate has a corresponding element of the <code class="docutils literal notranslate"><span class="pre">Shape</span></code>.</p></li>
</ul>
</li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">Stride</span></code> of a <code class="docutils literal notranslate"><span class="pre">Layout</span></code> maps coordinates to indices.</p>
<ul>
<li><p>The inner product of the elements of the natural coordinate with the elements of the <code class="docutils literal notranslate"><span class="pre">Stride</span></code> produces the resulting index.</p></li>
</ul>
</li>
</ul>
<p>For each <code class="docutils literal notranslate"><span class="pre">Layout</span></code> there exists an integral <code class="docutils literal notranslate"><span class="pre">Shape</span></code> that is that compatible with that <code class="docutils literal notranslate"><span class="pre">Layout</span></code>. Namely, that integral shape is <code class="docutils literal notranslate"><span class="pre">size(layout)</span></code>. We can then observe that</p>
<blockquote>
<div><p>Layouts are functions from integers to integers.</p>
</div></blockquote>
<p>If you’re familiar with the C++23 feature <code class="docutils literal notranslate"><span class="pre">mdspan</span></code>,
this is an important difference between
<code class="docutils literal notranslate"><span class="pre">mdspan</span></code> layout mappings and CuTe <code class="docutils literal notranslate"><span class="pre">Layout</span></code>s. In CuTe, <code class="docutils literal notranslate"><span class="pre">Layout</span></code> is a first class citizen, is natively hierarchical to naturally represent functions beyond row-major and column-major, and can similarly be indexed with a hierarchy of coordinates.
(<code class="docutils literal notranslate"><span class="pre">mdspan</span></code> layout mappings can represent hierarchical functions as well,
but this requires defining a custom layout.)
Input coordinates for an <code class="docutils literal notranslate"><span class="pre">mdspan</span></code> must have the same shape as the <code class="docutils literal notranslate"><span class="pre">mdspan</span></code>;
a multidimensional <code class="docutils literal notranslate"><span class="pre">mdspan</span></code> does not accept 1-D coordinates.</p>
</section>
<section id="copyright">
<h2>Copyright<a class="headerlink" href="#copyright" title="Link to this heading">#</a></h2>
<p>Copyright (c) 2017 - 2025 NVIDIA CORPORATION &amp; AFFILIATES. All rights reserved.
SPDX-License-Identifier: BSD-3-Clause</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>  <span class="n">Redistribution</span> <span class="ow">and</span> <span class="n">use</span> <span class="ow">in</span> <span class="n">source</span> <span class="ow">and</span> <span class="n">binary</span> <span class="n">forms</span><span class="p">,</span> <span class="k">with</span> <span class="ow">or</span> <span class="n">without</span>
  <span class="n">modification</span><span class="p">,</span> <span class="n">are</span> <span class="n">permitted</span> <span class="n">provided</span> <span class="n">that</span> <span class="n">the</span> <span class="n">following</span> <span class="n">conditions</span> <span class="n">are</span> <span class="n">met</span><span class="p">:</span>

  <span class="mf">1.</span> <span class="n">Redistributions</span> <span class="n">of</span> <span class="n">source</span> <span class="n">code</span> <span class="n">must</span> <span class="n">retain</span> <span class="n">the</span> <span class="n">above</span> <span class="n">copyright</span> <span class="n">notice</span><span class="p">,</span> <span class="n">this</span>
  <span class="nb">list</span> <span class="n">of</span> <span class="n">conditions</span> <span class="ow">and</span> <span class="n">the</span> <span class="n">following</span> <span class="n">disclaimer</span><span class="o">.</span>

  <span class="mf">2.</span> <span class="n">Redistributions</span> <span class="ow">in</span> <span class="n">binary</span> <span class="n">form</span> <span class="n">must</span> <span class="n">reproduce</span> <span class="n">the</span> <span class="n">above</span> <span class="n">copyright</span> <span class="n">notice</span><span class="p">,</span>
  <span class="n">this</span> <span class="nb">list</span> <span class="n">of</span> <span class="n">conditions</span> <span class="ow">and</span> <span class="n">the</span> <span class="n">following</span> <span class="n">disclaimer</span> <span class="ow">in</span> <span class="n">the</span> <span class="n">documentation</span>
  <span class="ow">and</span><span class="o">/</span><span class="ow">or</span> <span class="n">other</span> <span class="n">materials</span> <span class="n">provided</span> <span class="k">with</span> <span class="n">the</span> <span class="n">distribution</span><span class="o">.</span>

  <span class="mf">3.</span> <span class="n">Neither</span> <span class="n">the</span> <span class="n">name</span> <span class="n">of</span> <span class="n">the</span> <span class="n">copyright</span> <span class="n">holder</span> <span class="n">nor</span> <span class="n">the</span> <span class="n">names</span> <span class="n">of</span> <span class="n">its</span>
  <span class="n">contributors</span> <span class="n">may</span> <span class="n">be</span> <span class="n">used</span> <span class="n">to</span> <span class="n">endorse</span> <span class="ow">or</span> <span class="n">promote</span> <span class="n">products</span> <span class="n">derived</span> <span class="kn">from</span>
<span class="w">  </span><span class="nn">this</span> <span class="n">software</span> <span class="n">without</span> <span class="n">specific</span> <span class="n">prior</span> <span class="n">written</span> <span class="n">permission</span><span class="o">.</span>

  <span class="n">THIS</span> <span class="n">SOFTWARE</span> <span class="n">IS</span> <span class="n">PROVIDED</span> <span class="n">BY</span> <span class="n">THE</span> <span class="n">COPYRIGHT</span> <span class="n">HOLDERS</span> <span class="n">AND</span> <span class="n">CONTRIBUTORS</span> <span class="s2">&quot;AS IS&quot;</span>
  <span class="n">AND</span> <span class="n">ANY</span> <span class="n">EXPRESS</span> <span class="n">OR</span> <span class="n">IMPLIED</span> <span class="n">WARRANTIES</span><span class="p">,</span> <span class="n">INCLUDING</span><span class="p">,</span> <span class="n">BUT</span> <span class="n">NOT</span> <span class="n">LIMITED</span> <span class="n">TO</span><span class="p">,</span> <span class="n">THE</span>
  <span class="n">IMPLIED</span> <span class="n">WARRANTIES</span> <span class="n">OF</span> <span class="n">MERCHANTABILITY</span> <span class="n">AND</span> <span class="n">FITNESS</span> <span class="n">FOR</span> <span class="n">A</span> <span class="n">PARTICULAR</span> <span class="n">PURPOSE</span> <span class="n">ARE</span>
  <span class="n">DISCLAIMED</span><span class="o">.</span> <span class="n">IN</span> <span class="n">NO</span> <span class="n">EVENT</span> <span class="n">SHALL</span> <span class="n">THE</span> <span class="n">COPYRIGHT</span> <span class="n">HOLDER</span> <span class="n">OR</span> <span class="n">CONTRIBUTORS</span> <span class="n">BE</span> <span class="n">LIABLE</span>
  <span class="n">FOR</span> <span class="n">ANY</span> <span class="n">DIRECT</span><span class="p">,</span> <span class="n">INDIRECT</span><span class="p">,</span> <span class="n">INCIDENTAL</span><span class="p">,</span> <span class="n">SPECIAL</span><span class="p">,</span> <span class="n">EXEMPLARY</span><span class="p">,</span> <span class="n">OR</span> <span class="n">CONSEQUENTIAL</span>
  <span class="n">DAMAGES</span> <span class="p">(</span><span class="n">INCLUDING</span><span class="p">,</span> <span class="n">BUT</span> <span class="n">NOT</span> <span class="n">LIMITED</span> <span class="n">TO</span><span class="p">,</span> <span class="n">PROCUREMENT</span> <span class="n">OF</span> <span class="n">SUBSTITUTE</span> <span class="n">GOODS</span> <span class="n">OR</span>
  <span class="n">SERVICES</span><span class="p">;</span> <span class="n">LOSS</span> <span class="n">OF</span> <span class="n">USE</span><span class="p">,</span> <span class="n">DATA</span><span class="p">,</span> <span class="n">OR</span> <span class="n">PROFITS</span><span class="p">;</span> <span class="n">OR</span> <span class="n">BUSINESS</span> <span class="n">INTERRUPTION</span><span class="p">)</span> <span class="n">HOWEVER</span>
  <span class="n">CAUSED</span> <span class="n">AND</span> <span class="n">ON</span> <span class="n">ANY</span> <span class="n">THEORY</span> <span class="n">OF</span> <span class="n">LIABILITY</span><span class="p">,</span> <span class="n">WHETHER</span> <span class="n">IN</span> <span class="n">CONTRACT</span><span class="p">,</span> <span class="n">STRICT</span> <span class="n">LIABILITY</span><span class="p">,</span>
  <span class="n">OR</span> <span class="n">TORT</span> <span class="p">(</span><span class="n">INCLUDING</span> <span class="n">NEGLIGENCE</span> <span class="n">OR</span> <span class="n">OTHERWISE</span><span class="p">)</span> <span class="n">ARISING</span> <span class="n">IN</span> <span class="n">ANY</span> <span class="n">WAY</span> <span class="n">OUT</span> <span class="n">OF</span> <span class="n">THE</span> <span class="n">USE</span>
  <span class="n">OF</span> <span class="n">THIS</span> <span class="n">SOFTWARE</span><span class="p">,</span> <span class="n">EVEN</span> <span class="n">IF</span> <span class="n">ADVISED</span> <span class="n">OF</span> <span class="n">THE</span> <span class="n">POSSIBILITY</span> <span class="n">OF</span> <span class="n">SUCH</span> <span class="n">DAMAGE</span><span class="o">.</span>
</pre></div>
</div>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./cute"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="00_quickstart.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Getting Started With CuTe</p>
      </div>
    </a>
    <a class="right-next"
       href="02_layout_algebra.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">CuTe Layout Algebra</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#fundamental-types-and-concepts">Fundamental Types and Concepts</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#integers">Integers</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#tuple">Tuple</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#inttuple">IntTuple</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#shapes-and-strides">Shapes and Strides</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#layout">Layout</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#tensor">Tensor</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#layout-creation-and-use">Layout Creation and Use</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#hierarchical-access-functions">Hierarchical access functions</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#constructing-a-layout">Constructing a Layout</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#using-a-layout">Using a Layout</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#vector-layouts">Vector Layouts</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#matrix-examples">Matrix examples</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#layout-concepts">Layout Concepts</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#layout-compatibility">Layout compatibility</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#layouts-coordinates">Layouts Coordinates</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#coordinate-mapping">Coordinate Mapping</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#index-mapping">Index Mapping</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#layout-manipulation">Layout Manipulation</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#sublayouts">Sublayouts</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#concatenation">Concatenation</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#grouping-and-flattening">Grouping and flattening</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#slicing">Slicing</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#summary">Summary</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#copyright">Copyright</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By The Jupyter Book Community
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>